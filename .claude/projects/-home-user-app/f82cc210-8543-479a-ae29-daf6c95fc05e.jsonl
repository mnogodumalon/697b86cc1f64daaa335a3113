{"type":"queue-operation","operation":"enqueue","timestamp":"2026-02-06T12:34:15.023Z","content":"ğŸš¨ AUFGABE: Du MUSST das existierende Dashboard Ã¤ndern und deployen!\n\nUser-Anfrage: \"Dashboard anpassen\"\n\nPFLICHT-SCHRITTE (alle mÃ¼ssen ausgefÃ¼hrt werden):\n\n1. LESEN: Lies src/pages/Dashboard.tsx um die aktuelle Struktur zu verstehen\n2. Ã„NDERN: Implementiere die User-Anfrage mit dem Edit-Tool\n3. TESTEN: FÃ¼hre 'npm run build' aus um sicherzustellen dass es kompiliert\n4. DEPLOYEN: Rufe deploy_to_github auf um die Ã„nderungen zu pushen\n\nâš ï¸ KRITISCH:\n- Du MUSST Ã„nderungen am Code machen (Edit-Tool verwenden!)\n- Du MUSST am Ende deploy_to_github aufrufen!\n- Beende NICHT ohne zu deployen!\n- Analysieren alleine reicht NICHT - du musst HANDELN!\n\nDas Dashboard existiert bereits. Mache NUR die angeforderten Ã„nderungen, nicht mehr.\nStarte JETZT mit Schritt 1!","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e"}
{"type":"queue-operation","operation":"dequeue","timestamp":"2026-02-06T12:34:15.093Z","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e"}
{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","type":"user","message":{"role":"user","content":"ğŸš¨ AUFGABE: Du MUSST das existierende Dashboard Ã¤ndern und deployen!\n\nUser-Anfrage: \"Dashboard anpassen\"\n\nPFLICHT-SCHRITTE (alle mÃ¼ssen ausgefÃ¼hrt werden):\n\n1. LESEN: Lies src/pages/Dashboard.tsx um die aktuelle Struktur zu verstehen\n2. Ã„NDERN: Implementiere die User-Anfrage mit dem Edit-Tool\n3. TESTEN: FÃ¼hre 'npm run build' aus um sicherzustellen dass es kompiliert\n4. DEPLOYEN: Rufe deploy_to_github auf um die Ã„nderungen zu pushen\n\nâš ï¸ KRITISCH:\n- Du MUSST Ã„nderungen am Code machen (Edit-Tool verwenden!)\n- Du MUSST am Ende deploy_to_github aufrufen!\n- Beende NICHT ohne zu deployen!\n- Analysieren alleine reicht NICHT - du musst HANDELN!\n\nDas Dashboard existiert bereits. Mache NUR die angeforderten Ã„nderungen, nicht mehr.\nStarte JETZT mit Schritt 1!"},"uuid":"375c89b2-6f0b-49aa-bb0b-a8625aac0bf4","timestamp":"2026-02-06T12:34:15.694Z"}
{"parentUuid":"375c89b2-6f0b-49aa-bb0b-a8625aac0bf4","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","message":{"model":"claude-opus-4-6","id":"msg_012FrzrNu3qh2tEFLP3MRNdr","type":"message","role":"assistant","content":[{"type":"text","text":"I'll start by reading the current Dashboard.tsx and the app metadata to understand what exists and what changes might be needed."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":18331,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18331,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrph7LP9ZwaT1iCGuV8K","type":"assistant","uuid":"ffad9117-7a22-4e46-8f17-fec8659f1110","timestamp":"2026-02-06T12:34:18.523Z"}
{"parentUuid":"ffad9117-7a22-4e46-8f17-fec8659f1110","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","message":{"model":"claude-opus-4-6","id":"msg_012FrzrNu3qh2tEFLP3MRNdr","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01XBLbqRRHYXN3VF3x7zjpFm","name":"Read","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":18331,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18331,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrph7LP9ZwaT1iCGuV8K","type":"assistant","uuid":"1e4d8859-bf96-473b-94fd-a4b6955a162a","timestamp":"2026-02-06T12:34:18.786Z"}
{"parentUuid":"1e4d8859-bf96-473b-94fd-a4b6955a162a","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","message":{"model":"claude-opus-4-6","id":"msg_012FrzrNu3qh2tEFLP3MRNdr","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014i7WheWwAtSkDa1EnfgDqL","name":"Read","input":{"file_path":"/home/user/app/app_metadata.json"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":18331,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":18331,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrph7LP9ZwaT1iCGuV8K","type":"assistant","uuid":"504603ea-a23d-4e7d-a18d-ac84af8d55c4","timestamp":"2026-02-06T12:34:19.129Z"}
{"parentUuid":"504603ea-a23d-4e7d-a18d-ac84af8d55c4","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014i7WheWwAtSkDa1EnfgDqL","type":"tool_result","content":"     1â†’{\n     2â†’  \"appgroup_id\": \"697b86cc1f64daaa335a3113\",\n     3â†’  \"appgroup_name\": \"Werkzeugverwaltung\",\n     4â†’  \"apps\": {\n     5â†’    \"lagerorte\": {\n     6â†’      \"app_id\": \"697b8682ba3f894a922a88c8\",\n     7â†’      \"name\": \"Lagerorte\",\n     8â†’      \"controls\": {\n     9â†’        \"bezeichnung\": {\n    10â†’          \"identifier\": \"bezeichnung\",\n    11â†’          \"label\": \"Bezeichnung\",\n    12â†’          \"type\": \"string\",\n    13â†’          \"subtype\": \"text\",\n    14â†’          \"fulltype\": \"string/text\",\n    15â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n    16â†’          \"required\": null,\n    17â†’          \"in_list\": true,\n    18â†’          \"in_mobile_list\": true,\n    19â†’          \"in_text\": true,\n    20â†’          \"in_structured_search\": false,\n    21â†’          \"in_fulltext_search\": false,\n    22â†’          \"in_expert_search\": true\n    23â†’        },\n    24â†’        \"beschreibung\": {\n    25â†’          \"identifier\": \"beschreibung\",\n    26â†’          \"label\": \"Beschreibung\",\n    27â†’          \"type\": \"string\",\n    28â†’          \"subtype\": \"textarea\",\n    29â†’          \"fulltype\": \"string/textarea\",\n    30â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n    31â†’          \"required\": null,\n    32â†’          \"in_list\": true,\n    33â†’          \"in_mobile_list\": true,\n    34â†’          \"in_text\": true,\n    35â†’          \"in_structured_search\": false,\n    36â†’          \"in_fulltext_search\": false,\n    37â†’          \"in_expert_search\": true\n    38â†’        },\n    39â†’        \"lagerort_typ\": {\n    40â†’          \"identifier\": \"lagerort_typ\",\n    41â†’          \"label\": \"Typ des Lagerortes\",\n    42â†’          \"type\": \"lookup\",\n    43â†’          \"subtype\": \"select\",\n    44â†’          \"fulltype\": \"lookup/select\",\n    45â†’          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n    46â†’          \"required\": null,\n    47â†’          \"in_list\": true,\n    48â†’          \"in_mobile_list\": false,\n    49â†’          \"in_text\": false,\n    50â†’          \"in_structured_search\": false,\n    51â†’          \"in_fulltext_search\": false,\n    52â†’          \"in_expert_search\": true,\n    53â†’          \"lookup_data\": {\n    54â†’            \"hauptlager\": \"Hauptlager\",\n    55â†’            \"nebenlager\": \"Nebenlager\",\n    56â†’            \"firmenfahrzeug\": \"Firmenfahrzeug\",\n    57â†’            \"baustelle\": \"Baustelle\",\n    58â†’            \"werkstatt\": \"Werkstatt\",\n    59â†’            \"sonstiges\": \"Sonstiges\"\n    60â†’          }\n    61â†’        }\n    62â†’      }\n    63â†’    },\n    64â†’    \"mitarbeiter\": {\n    65â†’      \"app_id\": \"697b868b271cdba1f355487c\",\n    66â†’      \"name\": \"Mitarbeiter\",\n    67â†’      \"controls\": {\n    68â†’        \"vorname\": {\n    69â†’          \"identifier\": \"vorname\",\n    70â†’          \"label\": \"Vorname\",\n    71â†’          \"type\": \"string\",\n    72â†’          \"subtype\": \"text\",\n    73â†’          \"fulltype\": \"string/text\",\n    74â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n    75â†’          \"required\": null,\n    76â†’          \"in_list\": true,\n    77â†’          \"in_mobile_list\": true,\n    78â†’          \"in_text\": true,\n    79â†’          \"in_structured_search\": false,\n    80â†’          \"in_fulltext_search\": false,\n    81â†’          \"in_expert_search\": true\n    82â†’        },\n    83â†’        \"nachname\": {\n    84â†’          \"identifier\": \"nachname\",\n    85â†’          \"label\": \"Nachname\",\n    86â†’          \"type\": \"string\",\n    87â†’          \"subtype\": \"text\",\n    88â†’          \"fulltype\": \"string/text\",\n    89â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n    90â†’          \"required\": null,\n    91â†’          \"in_list\": true,\n    92â†’          \"in_mobile_list\": true,\n    93â†’          \"in_text\": true,\n    94â†’          \"in_structured_search\": false,\n    95â†’          \"in_fulltext_search\": false,\n    96â†’          \"in_expert_search\": true\n    97â†’        },\n    98â†’        \"personalnummer\": {\n    99â†’          \"identifier\": \"personalnummer\",\n   100â†’          \"label\": \"Personalnummer\",\n   101â†’          \"type\": \"string\",\n   102â†’          \"subtype\": \"text\",\n   103â†’          \"fulltype\": \"string/text\",\n   104â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n   105â†’          \"required\": null,\n   106â†’          \"in_list\": true,\n   107â†’          \"in_mobile_list\": false,\n   108â†’          \"in_text\": false,\n   109â†’          \"in_structured_search\": false,\n   110â†’          \"in_fulltext_search\": false,\n   111â†’          \"in_expert_search\": true\n   112â†’        },\n   113â†’        \"email\": {\n   114â†’          \"identifier\": \"email\",\n   115â†’          \"label\": \"E-Mail\",\n   116â†’          \"type\": \"string\",\n   117â†’          \"subtype\": \"email\",\n   118â†’          \"fulltype\": \"string/email\",\n   119â†’          \"description\": \"A valid email address (or `null`).\",\n   120â†’          \"required\": null,\n   121â†’          \"in_list\": true,\n   122â†’          \"in_mobile_list\": false,\n   123â†’          \"in_text\": false,\n   124â†’          \"in_structured_search\": false,\n   125â†’          \"in_fulltext_search\": false,\n   126â†’          \"in_expert_search\": true\n   127â†’        },\n   128â†’        \"telefon\": {\n   129â†’          \"identifier\": \"telefon\",\n   130â†’          \"label\": \"Telefon\",\n   131â†’          \"type\": \"string\",\n   132â†’          \"subtype\": \"tel\",\n   133â†’          \"fulltype\": \"string/tel\",\n   134â†’          \"description\": \"A valid telephone number. Might include country prefix and should include area code (or `null`).\",\n   135â†’          \"required\": null,\n   136â†’          \"in_list\": true,\n   137â†’          \"in_mobile_list\": false,\n   138â†’          \"in_text\": false,\n   139â†’          \"in_structured_search\": false,\n   140â†’          \"in_fulltext_search\": false,\n   141â†’          \"in_expert_search\": true\n   142â†’        },\n   143â†’        \"abteilung\": {\n   144â†’          \"identifier\": \"abteilung\",\n   145â†’          \"label\": \"Abteilung\",\n   146â†’          \"type\": \"lookup\",\n   147â†’          \"subtype\": \"select\",\n   148â†’          \"fulltype\": \"lookup/select\",\n   149â†’          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n   150â†’          \"required\": null,\n   151â†’          \"in_list\": false,\n   152â†’          \"in_mobile_list\": false,\n   153â†’          \"in_text\": false,\n   154â†’          \"in_structured_search\": false,\n   155â†’          \"in_fulltext_search\": false,\n   156â†’          \"in_expert_search\": true,\n   157â†’          \"lookup_data\": {\n   158â†’            \"bauleitung\": \"Bauleitung\",\n   159â†’            \"lager\": \"Lager\",\n   160â†’            \"verwaltung\": \"Verwaltung\",\n   161â†’            \"elektroinstallation\": \"Elektroinstallation\",\n   162â†’            \"wartung\": \"Wartung\",\n   163â†’            \"kundendienst\": \"Kundendienst\"\n   164â†’          }\n   165â†’        }\n   166â†’      }\n   167â†’    },\n   168â†’    \"werkzeuge\": {\n   169â†’      \"app_id\": \"697b868cc0013ffdb5f1e82d\",\n   170â†’      \"name\": \"Werkzeuge\",\n   171â†’      \"controls\": {\n   172â†’        \"werkzeugname\": {\n   173â†’          \"identifier\": \"werkzeugname\",\n   174â†’          \"label\": \"Werkzeugname\",\n   175â†’          \"type\": \"string\",\n   176â†’          \"subtype\": \"text\",\n   177â†’          \"fulltype\": \"string/text\",\n   178â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n   179â†’          \"required\": null,\n   180â†’          \"in_list\": true,\n   181â†’          \"in_mobile_list\": true,\n   182â†’          \"in_text\": true,\n   183â†’          \"in_structured_search\": false,\n   184â†’          \"in_fulltext_search\": false,\n   185â†’          \"in_expert_search\": true\n   186â†’        },\n   187â†’        \"hersteller\": {\n   188â†’          \"identifier\": \"hersteller\",\n   189â†’          \"label\": \"Hersteller\",\n   190â†’          \"type\": \"string\",\n   191â†’          \"subtype\": \"text\",\n   192â†’          \"fulltype\": \"string/text\",\n   193â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n   194â†’          \"required\": null,\n   195â†’          \"in_list\": true,\n   196â†’          \"in_mobile_list\": true,\n   197â†’          \"in_text\": true,\n   198â†’          \"in_structured_search\": false,\n   199â†’          \"in_fulltext_search\": false,\n   200â†’          \"in_expert_search\": true\n   201â†’        },\n   202â†’        \"modell\": {\n   203â†’          \"identifier\": \"modell\",\n   204â†’          \"label\": \"Modell\",\n   205â†’          \"type\": \"string\",\n   206â†’          \"subtype\": \"text\",\n   207â†’          \"fulltype\": \"string/text\",\n   208â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n   209â†’          \"required\": null,\n   210â†’          \"in_list\": true,\n   211â†’          \"in_mobile_list\": false,\n   212â†’          \"in_text\": false,\n   213â†’          \"in_structured_search\": false,\n   214â†’          \"in_fulltext_search\": false,\n   215â†’          \"in_expert_search\": true\n   216â†’        },\n   217â†’        \"seriennummer\": {\n   218â†’          \"identifier\": \"seriennummer\",\n   219â†’          \"label\": \"Seriennummer\",\n   220â†’          \"type\": \"string\",\n   221â†’          \"subtype\": \"text\",\n   222â†’          \"fulltype\": \"string/text\",\n   223â†’          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n   224â†’          \"required\": null,\n   225â†’          \"in_list\": true,\n   226â†’          \"in_mobile_list\": false,\n   227â†’          \"in_text\": false,\n   228â†’          \"in_structured_search\": false,\n   229â†’          \"in_fulltext_search\": false,\n   230â†’          \"in_expert_search\": true\n   231â†’        },\n   232â†’        \"anschaffungsdatum\": {\n   233â†’          \"identifier\": \"anschaffungsdatum\",\n   234â†’          \"label\": \"Anschaffungsdatum\",\n   235â†’          \"type\": \"date\",\n   236â†’          \"subtype\": \"date\",\n   237â†’          \"fulltype\": \"date/date\",\n   238â†’          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n   239â†’          \"required\": null,\n   240â†’          \"in_list\": true,\n   241â†’          \"in_mobile_list\": false,\n   242â†’          \"in_text\": false,\n   243â†’          \"in_structured_search\": false,\n   244â†’          \"in_fulltext_search\": false,\n   245â†’          \"in_expert_search\": true\n   246â†’        },\n   247â†’        \"anschaffungspreis\": {\n   248â†’          \"identifier\": \"anschaffungspreis\",\n   249â†’          \"label\": \"Anschaffungspreis (EUR)\",\n   250â†’          \"type\": \"number\",\n   251â†’          \"subtype\": null,\n   252â†’          \"fulltype\": \"number\",\n   253â†’          \"description\": \"A decimal number value (or `null`).\",\n   254â†’          \"required\": null,\n   255â†’          \"in_list\": false,\n   256â†’          \"in_mobile_list\": false,\n   257â†’          \"in_text\": false,\n   258â†’          \"in_structured_search\": false,\n   259â†’          \"in_fulltext_search\": false,\n   260â†’          \"in_expert_search\": true,\n   261â†’          \"precision\": null\n   262â†’        },\n   263â†’        \"aktueller_lagerort\": {\n   264â†’          \"identifier\": \"aktueller_lagerort\",\n   265â†’          \"label\": \"Aktueller Lagerort\",\n   266â†’          \"type\": \"applookup\",\n   267â†’          \"subtype\": \"select\",\n   268â†’          \"fulltype\": \"applookup/select\",\n   269â†’          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n   270â†’          \"required\": null,\n   271â†’          \"in_list\": false,\n   272â†’          \"in_mobile_list\": false,\n   273â†’          \"in_text\": false,\n   274â†’          \"in_structured_search\": false,\n   275â†’          \"in_fulltext_search\": false,\n   276â†’          \"in_expert_search\": true,\n   277â†’          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b8682ba3f894a922a88c8\"\n   278â†’        },\n   279â†’        \"zustand\": {\n   280â†’          \"identifier\": \"zustand\",\n   281â†’          \"label\": \"Zustand\",\n   282â†’          \"type\": \"lookup\",\n   283â†’          \"subtype\": \"select\",\n   284â†’          \"fulltype\": \"lookup/select\",\n   285â†’          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n   286â†’          \"required\": null,\n   287â†’          \"in_list\": false,\n   288â†’          \"in_mobile_list\": false,\n   289â†’          \"in_text\": false,\n   290â†’          \"in_structured_search\": false,\n   291â†’          \"in_fulltext_search\": false,\n   292â†’          \"in_expert_search\": true,\n   293â†’          \"lookup_data\": {\n   294â†’            \"gut\": \"Gut\",\n   295â†’            \"befriedigend\": \"Befriedigend\",\n   296â†’            \"ausreichend\": \"Ausreichend\",\n   297â†’            \"defekt\": \"Defekt\",\n   298â†’            \"neu\": \"Neu\",\n   299â†’            \"sehr_gut\": \"Sehr gut\"\n   300â†’          }\n   301â†’        },\n   302â†’        \"wartungsintervall_monate\": {\n   303â†’          \"identifier\": \"wartungsintervall_monate\",\n   304â†’          \"label\": \"Wartungsintervall (Monate)\",\n   305â†’          \"type\": \"number\",\n   306â†’          \"subtype\": null,\n   307â†’          \"fulltype\": \"number\",\n   308â†’          \"description\": \"A decimal number value (or `null`).\",\n   309â†’          \"required\": null,\n   310â†’          \"in_list\": false,\n   311â†’          \"in_mobile_list\": false,\n   312â†’          \"in_text\": false,\n   313â†’          \"in_structured_search\": false,\n   314â†’          \"in_fulltext_search\": false,\n   315â†’          \"in_expert_search\": true,\n   316â†’          \"precision\": null\n   317â†’        },\n   318â†’        \"naechste_wartung\": {\n   319â†’          \"identifier\": \"naechste_wartung\",\n   320â†’          \"label\": \"N\\u00e4chste Wartung\",\n   321â†’          \"type\": \"date\",\n   322â†’          \"subtype\": \"date\",\n   323â†’          \"fulltype\": \"date/date\",\n   324â†’          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n   325â†’          \"required\": null,\n   326â†’          \"in_list\": false,\n   327â†’          \"in_mobile_list\": false,\n   328â†’          \"in_text\": false,\n   329â†’          \"in_structured_search\": false,\n   330â†’          \"in_fulltext_search\": false,\n   331â†’          \"in_expert_search\": true\n   332â†’        },\n   333â†’        \"notizen\": {\n   334â†’          \"identifier\": \"notizen\",\n   335â†’          \"label\": \"Notizen\",\n   336â†’          \"type\": \"string\",\n   337â†’          \"subtype\": \"textarea\",\n   338â†’          \"fulltype\": \"string/textarea\",\n   339â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n   340â†’          \"required\": null,\n   341â†’          \"in_list\": false,\n   342â†’          \"in_mobile_list\": false,\n   343â†’          \"in_text\": false,\n   344â†’          \"in_structured_search\": false,\n   345â†’          \"in_fulltext_search\": false,\n   346â†’          \"in_expert_search\": true\n   347â†’        }\n   348â†’      }\n   349â†’    },\n   350â†’    \"werkzeugausgabe\": {\n   351â†’      \"app_id\": \"697b868d6b34303ccedce8ad\",\n   352â†’      \"name\": \"Werkzeugausgabe\",\n   353â†’      \"controls\": {\n   354â†’        \"werkzeug\": {\n   355â†’          \"identifier\": \"werkzeug\",\n   356â†’          \"label\": \"Werkzeug\",\n   357â†’          \"type\": \"applookup\",\n   358â†’          \"subtype\": \"select\",\n   359â†’          \"fulltype\": \"applookup/select\",\n   360â†’          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n   361â†’          \"required\": null,\n   362â†’          \"in_list\": true,\n   363â†’          \"in_mobile_list\": true,\n   364â†’          \"in_text\": true,\n   365â†’          \"in_structured_search\": false,\n   366â†’          \"in_fulltext_search\": false,\n   367â†’          \"in_expert_search\": true,\n   368â†’          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868cc0013ffdb5f1e82d\"\n   369â†’        },\n   370â†’        \"mitarbeiter\": {\n   371â†’          \"identifier\": \"mitarbeiter\",\n   372â†’          \"label\": \"Mitarbeiter\",\n   373â†’          \"type\": \"applookup\",\n   374â†’          \"subtype\": \"select\",\n   375â†’          \"fulltype\": \"applookup/select\",\n   376â†’          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n   377â†’          \"required\": null,\n   378â†’          \"in_list\": true,\n   379â†’          \"in_mobile_list\": true,\n   380â†’          \"in_text\": true,\n   381â†’          \"in_structured_search\": false,\n   382â†’          \"in_fulltext_search\": false,\n   383â†’          \"in_expert_search\": true,\n   384â†’          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868b271cdba1f355487c\"\n   385â†’        },\n   386â†’        \"ausgabedatum\": {\n   387â†’          \"identifier\": \"ausgabedatum\",\n   388â†’          \"label\": \"Ausgabedatum\",\n   389â†’          \"type\": \"date\",\n   390â†’          \"subtype\": \"datetimeminute\",\n   391â†’          \"fulltype\": \"date/datetimeminute\",\n   392â†’          \"description\": \"A specific moment in time consisting of year, month, day, hour and minute. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>T<HH>:<MM>` or `null`.\\n\\nFor example: `1879-03-14T11:30`.\",\n   393â†’          \"required\": null,\n   394â†’          \"in_list\": true,\n   395â†’          \"in_mobile_list\": false,\n   396â†’          \"in_text\": false,\n   397â†’          \"in_structured_search\": false,\n   398â†’          \"in_fulltext_search\": false,\n   399â†’          \"in_expert_search\": true\n   400â†’        },\n   401â†’        \"geplantes_rueckgabedatum\": {\n   402â†’          \"identifier\": \"geplantes_rueckgabedatum\",\n   403â†’          \"label\": \"Geplantes R\\u00fcckgabedatum\",\n   404â†’          \"type\": \"date\",\n   405â†’          \"subtype\": \"date\",\n   406â†’          \"fulltype\": \"date/date\",\n   407â†’          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n   408â†’          \"required\": null,\n   409â†’          \"in_list\": true,\n   410â†’          \"in_mobile_list\": false,\n   411â†’          \"in_text\": false,\n   412â†’          \"in_structured_search\": false,\n   413â†’          \"in_fulltext_search\": false,\n   414â†’          \"in_expert_search\": true\n   415â†’        },\n   416â†’        \"verwendungszweck\": {\n   417â†’          \"identifier\": \"verwendungszweck\",\n   418â†’          \"label\": \"Verwendungszweck\",\n   419â†’          \"type\": \"string\",\n   420â†’          \"subtype\": \"textarea\",\n   421â†’          \"fulltype\": \"string/textarea\",\n   422â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n   423â†’          \"required\": null,\n   424â†’          \"in_list\": true,\n   425â†’          \"in_mobile_list\": false,\n   426â†’          \"in_text\": false,\n   427â†’          \"in_structured_search\": false,\n   428â†’          \"in_fulltext_search\": false,\n   429â†’          \"in_expert_search\": true\n   430â†’        },\n   431â†’        \"ausgabe_notizen\": {\n   432â†’          \"identifier\": \"ausgabe_notizen\",\n   433â†’          \"label\": \"Notizen\",\n   434â†’          \"type\": \"string\",\n   435â†’          \"subtype\": \"textarea\",\n   436â†’          \"fulltype\": \"string/textarea\",\n   437â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n   438â†’          \"required\": null,\n   439â†’          \"in_list\": false,\n   440â†’          \"in_mobile_list\": false,\n   441â†’          \"in_text\": false,\n   442â†’          \"in_structured_search\": false,\n   443â†’          \"in_fulltext_search\": false,\n   444â†’          \"in_expert_search\": true\n   445â†’        }\n   446â†’      }\n   447â†’    },\n   448â†’    \"werkzeugrueckgabe\": {\n   449â†’      \"app_id\": \"697b868ded3c30177996c1c9\",\n   450â†’      \"name\": \"Werkzeugr\\u00fcckgabe\",\n   451â†’      \"controls\": {\n   452â†’        \"werkzeugausgabe\": {\n   453â†’          \"identifier\": \"werkzeugausgabe\",\n   454â†’          \"label\": \"Werkzeugausgabe\",\n   455â†’          \"type\": \"applookup\",\n   456â†’          \"subtype\": \"select\",\n   457â†’          \"fulltype\": \"applookup/select\",\n   458â†’          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n   459â†’          \"required\": null,\n   460â†’          \"in_list\": true,\n   461â†’          \"in_mobile_list\": true,\n   462â†’          \"in_text\": true,\n   463â†’          \"in_structured_search\": false,\n   464â†’          \"in_fulltext_search\": false,\n   465â†’          \"in_expert_search\": true,\n   466â†’          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868d6b34303ccedce8ad\"\n   467â†’        },\n   468â†’        \"rueckgabedatum\": {\n   469â†’          \"identifier\": \"rueckgabedatum\",\n   470â†’          \"label\": \"Tats\\u00e4chliches R\\u00fcckgabedatum\",\n   471â†’          \"type\": \"date\",\n   472â†’          \"subtype\": \"datetimeminute\",\n   473â†’          \"fulltype\": \"date/datetimeminute\",\n   474â†’          \"description\": \"A specific moment in time consisting of year, month, day, hour and minute. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>T<HH>:<MM>` or `null`.\\n\\nFor example: `1879-03-14T11:30`.\",\n   475â†’          \"required\": null,\n   476â†’          \"in_list\": true,\n   477â†’          \"in_mobile_list\": true,\n   478â†’          \"in_text\": true,\n   479â†’          \"in_structured_search\": false,\n   480â†’          \"in_fulltext_search\": false,\n   481â†’          \"in_expert_search\": true\n   482â†’        },\n   483â†’        \"zustand_bei_rueckgabe\": {\n   484â†’          \"identifier\": \"zustand_bei_rueckgabe\",\n   485â†’          \"label\": \"Zustand bei R\\u00fcckgabe\",\n   486â†’          \"type\": \"lookup\",\n   487â†’          \"subtype\": \"select\",\n   488â†’          \"fulltype\": \"lookup/select\",\n   489â†’          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n   490â†’          \"required\": null,\n   491â†’          \"in_list\": true,\n   492â†’          \"in_mobile_list\": false,\n   493â†’          \"in_text\": false,\n   494â†’          \"in_structured_search\": false,\n   495â†’          \"in_fulltext_search\": false,\n   496â†’          \"in_expert_search\": true,\n   497â†’          \"lookup_data\": {\n   498â†’            \"wie_ausgegeben\": \"Wie ausgegeben\",\n   499â†’            \"leichte_gebrauchsspuren\": \"Leichte Gebrauchsspuren\",\n   500â†’            \"starke_gebrauchsspuren\": \"Starke Gebrauchsspuren\",\n   501â†’            \"beschaedigt\": \"Besch\\u00e4digt\",\n   502â†’            \"defekt\": \"Defekt\"\n   503â†’          }\n   504â†’        },\n   505â†’        \"beschaedigungen\": {\n   506â†’          \"identifier\": \"beschaedigungen\",\n   507â†’          \"label\": \"Besch\\u00e4digungen\",\n   508â†’          \"type\": \"string\",\n   509â†’          \"subtype\": \"textarea\",\n   510â†’          \"fulltype\": \"string/textarea\",\n   511â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n   512â†’          \"required\": null,\n   513â†’          \"in_list\": true,\n   514â†’          \"in_mobile_list\": false,\n   515â†’          \"in_text\": false,\n   516â†’          \"in_structured_search\": false,\n   517â†’          \"in_fulltext_search\": false,\n   518â†’          \"in_expert_search\": true\n   519â†’        },\n   520â†’        \"rueckgabe_notizen\": {\n   521â†’          \"identifier\": \"rueckgabe_notizen\",\n   522â†’          \"label\": \"Notizen\",\n   523â†’          \"type\": \"string\",\n   524â†’          \"subtype\": \"textarea\",\n   525â†’          \"fulltype\": \"string/textarea\",\n   526â†’          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n   527â†’          \"required\": null,\n   528â†’          \"in_list\": true,\n   529â†’          \"in_mobile_list\": false,\n   530â†’          \"in_text\": false,\n   531â†’          \"in_structured_search\": false,\n   532â†’          \"in_fulltext_search\": false,\n   533â†’          \"in_expert_search\": true\n   534â†’        }\n   535â†’      }\n   536â†’    }\n   537â†’  },\n   538â†’  \"metadata\": {\n   539â†’    \"apps_list\": [\n   540â†’      \"Lagerorte\",\n   541â†’      \"Mitarbeiter\",\n   542â†’      \"Werkzeuge\",\n   543â†’      \"Werkzeugausgabe\",\n   544â†’      \"Werkzeugr\\u00fcckgabe\"\n   545â†’    ]\n   546â†’  }\n   547â†’}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"6da922ca-bf40-45e0-9309-4a5c96e26075","timestamp":"2026-02-06T12:34:19.225Z","toolUseResult":{"type":"text","file":{"filePath":"/home/user/app/app_metadata.json","content":"{\n  \"appgroup_id\": \"697b86cc1f64daaa335a3113\",\n  \"appgroup_name\": \"Werkzeugverwaltung\",\n  \"apps\": {\n    \"lagerorte\": {\n      \"app_id\": \"697b8682ba3f894a922a88c8\",\n      \"name\": \"Lagerorte\",\n      \"controls\": {\n        \"bezeichnung\": {\n          \"identifier\": \"bezeichnung\",\n          \"label\": \"Bezeichnung\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"beschreibung\": {\n          \"identifier\": \"beschreibung\",\n          \"label\": \"Beschreibung\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"lagerort_typ\": {\n          \"identifier\": \"lagerort_typ\",\n          \"label\": \"Typ des Lagerortes\",\n          \"type\": \"lookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"lookup/select\",\n          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_data\": {\n            \"hauptlager\": \"Hauptlager\",\n            \"nebenlager\": \"Nebenlager\",\n            \"firmenfahrzeug\": \"Firmenfahrzeug\",\n            \"baustelle\": \"Baustelle\",\n            \"werkstatt\": \"Werkstatt\",\n            \"sonstiges\": \"Sonstiges\"\n          }\n        }\n      }\n    },\n    \"mitarbeiter\": {\n      \"app_id\": \"697b868b271cdba1f355487c\",\n      \"name\": \"Mitarbeiter\",\n      \"controls\": {\n        \"vorname\": {\n          \"identifier\": \"vorname\",\n          \"label\": \"Vorname\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"nachname\": {\n          \"identifier\": \"nachname\",\n          \"label\": \"Nachname\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"personalnummer\": {\n          \"identifier\": \"personalnummer\",\n          \"label\": \"Personalnummer\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"email\": {\n          \"identifier\": \"email\",\n          \"label\": \"E-Mail\",\n          \"type\": \"string\",\n          \"subtype\": \"email\",\n          \"fulltype\": \"string/email\",\n          \"description\": \"A valid email address (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"telefon\": {\n          \"identifier\": \"telefon\",\n          \"label\": \"Telefon\",\n          \"type\": \"string\",\n          \"subtype\": \"tel\",\n          \"fulltype\": \"string/tel\",\n          \"description\": \"A valid telephone number. Might include country prefix and should include area code (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"abteilung\": {\n          \"identifier\": \"abteilung\",\n          \"label\": \"Abteilung\",\n          \"type\": \"lookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"lookup/select\",\n          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_data\": {\n            \"bauleitung\": \"Bauleitung\",\n            \"lager\": \"Lager\",\n            \"verwaltung\": \"Verwaltung\",\n            \"elektroinstallation\": \"Elektroinstallation\",\n            \"wartung\": \"Wartung\",\n            \"kundendienst\": \"Kundendienst\"\n          }\n        }\n      }\n    },\n    \"werkzeuge\": {\n      \"app_id\": \"697b868cc0013ffdb5f1e82d\",\n      \"name\": \"Werkzeuge\",\n      \"controls\": {\n        \"werkzeugname\": {\n          \"identifier\": \"werkzeugname\",\n          \"label\": \"Werkzeugname\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"hersteller\": {\n          \"identifier\": \"hersteller\",\n          \"label\": \"Hersteller\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"modell\": {\n          \"identifier\": \"modell\",\n          \"label\": \"Modell\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"seriennummer\": {\n          \"identifier\": \"seriennummer\",\n          \"label\": \"Seriennummer\",\n          \"type\": \"string\",\n          \"subtype\": \"text\",\n          \"fulltype\": \"string/text\",\n          \"description\": \"A string value not longer than 4000 characters (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"anschaffungsdatum\": {\n          \"identifier\": \"anschaffungsdatum\",\n          \"label\": \"Anschaffungsdatum\",\n          \"type\": \"date\",\n          \"subtype\": \"date\",\n          \"fulltype\": \"date/date\",\n          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"anschaffungspreis\": {\n          \"identifier\": \"anschaffungspreis\",\n          \"label\": \"Anschaffungspreis (EUR)\",\n          \"type\": \"number\",\n          \"subtype\": null,\n          \"fulltype\": \"number\",\n          \"description\": \"A decimal number value (or `null`).\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"precision\": null\n        },\n        \"aktueller_lagerort\": {\n          \"identifier\": \"aktueller_lagerort\",\n          \"label\": \"Aktueller Lagerort\",\n          \"type\": \"applookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"applookup/select\",\n          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b8682ba3f894a922a88c8\"\n        },\n        \"zustand\": {\n          \"identifier\": \"zustand\",\n          \"label\": \"Zustand\",\n          \"type\": \"lookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"lookup/select\",\n          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_data\": {\n            \"gut\": \"Gut\",\n            \"befriedigend\": \"Befriedigend\",\n            \"ausreichend\": \"Ausreichend\",\n            \"defekt\": \"Defekt\",\n            \"neu\": \"Neu\",\n            \"sehr_gut\": \"Sehr gut\"\n          }\n        },\n        \"wartungsintervall_monate\": {\n          \"identifier\": \"wartungsintervall_monate\",\n          \"label\": \"Wartungsintervall (Monate)\",\n          \"type\": \"number\",\n          \"subtype\": null,\n          \"fulltype\": \"number\",\n          \"description\": \"A decimal number value (or `null`).\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"precision\": null\n        },\n        \"naechste_wartung\": {\n          \"identifier\": \"naechste_wartung\",\n          \"label\": \"N\\u00e4chste Wartung\",\n          \"type\": \"date\",\n          \"subtype\": \"date\",\n          \"fulltype\": \"date/date\",\n          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"notizen\": {\n          \"identifier\": \"notizen\",\n          \"label\": \"Notizen\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        }\n      }\n    },\n    \"werkzeugausgabe\": {\n      \"app_id\": \"697b868d6b34303ccedce8ad\",\n      \"name\": \"Werkzeugausgabe\",\n      \"controls\": {\n        \"werkzeug\": {\n          \"identifier\": \"werkzeug\",\n          \"label\": \"Werkzeug\",\n          \"type\": \"applookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"applookup/select\",\n          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868cc0013ffdb5f1e82d\"\n        },\n        \"mitarbeiter\": {\n          \"identifier\": \"mitarbeiter\",\n          \"label\": \"Mitarbeiter\",\n          \"type\": \"applookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"applookup/select\",\n          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868b271cdba1f355487c\"\n        },\n        \"ausgabedatum\": {\n          \"identifier\": \"ausgabedatum\",\n          \"label\": \"Ausgabedatum\",\n          \"type\": \"date\",\n          \"subtype\": \"datetimeminute\",\n          \"fulltype\": \"date/datetimeminute\",\n          \"description\": \"A specific moment in time consisting of year, month, day, hour and minute. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>T<HH>:<MM>` or `null`.\\n\\nFor example: `1879-03-14T11:30`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"geplantes_rueckgabedatum\": {\n          \"identifier\": \"geplantes_rueckgabedatum\",\n          \"label\": \"Geplantes R\\u00fcckgabedatum\",\n          \"type\": \"date\",\n          \"subtype\": \"date\",\n          \"fulltype\": \"date/date\",\n          \"description\": \"A calendar date consisting of year, month and day. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>` or `null`.\\n\\nFor example: `1642-12-25`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"verwendungszweck\": {\n          \"identifier\": \"verwendungszweck\",\n          \"label\": \"Verwendungszweck\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"ausgabe_notizen\": {\n          \"identifier\": \"ausgabe_notizen\",\n          \"label\": \"Notizen\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": false,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        }\n      }\n    },\n    \"werkzeugrueckgabe\": {\n      \"app_id\": \"697b868ded3c30177996c1c9\",\n      \"name\": \"Werkzeugr\\u00fcckgabe\",\n      \"controls\": {\n        \"werkzeugausgabe\": {\n          \"identifier\": \"werkzeugausgabe\",\n          \"label\": \"Werkzeugausgabe\",\n          \"type\": \"applookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"applookup/select\",\n          \"description\": \"A reference to another LivingApp record from a target lookup app (or `null`).\\n\\nThe field value will be a valid record URL in the form `https://<hostname>/rest/apps/<app-id>/records/<record-id>` or `null`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_app\": \"https://my.living-apps.de/rest/apps/697b868d6b34303ccedce8ad\"\n        },\n        \"rueckgabedatum\": {\n          \"identifier\": \"rueckgabedatum\",\n          \"label\": \"Tats\\u00e4chliches R\\u00fcckgabedatum\",\n          \"type\": \"date\",\n          \"subtype\": \"datetimeminute\",\n          \"fulltype\": \"date/datetimeminute\",\n          \"description\": \"A specific moment in time consisting of year, month, day, hour and minute. (Or `null`/`None`)\\n\\nThe field value will be a string in the format `<YYYY>-<MM>-<DD>T<HH>:<MM>` or `null`.\\n\\nFor example: `1879-03-14T11:30`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": true,\n          \"in_text\": true,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"zustand_bei_rueckgabe\": {\n          \"identifier\": \"zustand_bei_rueckgabe\",\n          \"label\": \"Zustand bei R\\u00fcckgabe\",\n          \"type\": \"lookup\",\n          \"subtype\": \"select\",\n          \"fulltype\": \"lookup/select\",\n          \"description\": \"One selected option of multiple available options (or `null`).\\n\\nThe available options are defined in the `lookup_data` attribute of this control's LivingApp.\\n\\nThe field value will be the key in this `lookup_data` attribute or `null`.\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true,\n          \"lookup_data\": {\n            \"wie_ausgegeben\": \"Wie ausgegeben\",\n            \"leichte_gebrauchsspuren\": \"Leichte Gebrauchsspuren\",\n            \"starke_gebrauchsspuren\": \"Starke Gebrauchsspuren\",\n            \"beschaedigt\": \"Besch\\u00e4digt\",\n            \"defekt\": \"Defekt\"\n          }\n        },\n        \"beschaedigungen\": {\n          \"identifier\": \"beschaedigungen\",\n          \"label\": \"Besch\\u00e4digungen\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        },\n        \"rueckgabe_notizen\": {\n          \"identifier\": \"rueckgabe_notizen\",\n          \"label\": \"Notizen\",\n          \"type\": \"string\",\n          \"subtype\": \"textarea\",\n          \"fulltype\": \"string/textarea\",\n          \"description\": \"A string value that can contain multiple lines of text (or `null`).\",\n          \"required\": null,\n          \"in_list\": true,\n          \"in_mobile_list\": false,\n          \"in_text\": false,\n          \"in_structured_search\": false,\n          \"in_fulltext_search\": false,\n          \"in_expert_search\": true\n        }\n      }\n    }\n  },\n  \"metadata\": {\n    \"apps_list\": [\n      \"Lagerorte\",\n      \"Mitarbeiter\",\n      \"Werkzeuge\",\n      \"Werkzeugausgabe\",\n      \"Werkzeugr\\u00fcckgabe\"\n    ]\n  }\n}","numLines":547,"startLine":1,"totalLines":547}}}
{"parentUuid":"6da922ca-bf40-45e0-9309-4a5c96e26075","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01XBLbqRRHYXN3VF3x7zjpFm","type":"tool_result","content":"     1â†’import { useState, useEffect, useMemo } from 'react';\n     2â†’import type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\n     3â†’import { APP_IDS } from '@/types/app';\n     4â†’import { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\n     5â†’import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\n     6â†’import { Button } from '@/components/ui/button';\n     7â†’import { Badge } from '@/components/ui/badge';\n     8â†’import { Skeleton } from '@/components/ui/skeleton';\n     9â†’import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\n    10â†’import {\n    11â†’  Dialog,\n    12â†’  DialogContent,\n    13â†’  DialogHeader,\n    14â†’  DialogTitle,\n    15â†’  DialogTrigger,\n    16â†’} from '@/components/ui/dialog';\n    17â†’import {\n    18â†’  Select,\n    19â†’  SelectContent,\n    20â†’  SelectItem,\n    21â†’  SelectTrigger,\n    22â†’  SelectValue,\n    23â†’} from '@/components/ui/select';\n    24â†’import { Input } from '@/components/ui/input';\n    25â†’import { Label } from '@/components/ui/label';\n    26â†’import { Textarea } from '@/components/ui/textarea';\n    27â†’import {\n    28â†’  Sheet,\n    29â†’  SheetContent,\n    30â†’  SheetHeader,\n    31â†’  SheetTitle,\n    32â†’} from '@/components/ui/sheet';\n    33â†’import {\n    34â†’  Table,\n    35â†’  TableBody,\n    36â†’  TableCell,\n    37â†’  TableHead,\n    38â†’  TableHeader,\n    39â†’  TableRow,\n    40â†’} from '@/components/ui/table';\n    41â†’import { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\n    42â†’import { de } from 'date-fns/locale';\n    43â†’import {\n    44â†’  Wrench,\n    45â†’  AlertCircle,\n    46â†’  Clock,\n    47â†’  MapPin,\n    48â†’  Users,\n    49â†’  Settings,\n    50â†’  Plus,\n    51â†’  ArrowRight,\n    52â†’  CalendarDays,\n    53â†’  Package,\n    54â†’  RefreshCw,\n    55â†’} from 'lucide-react';\n    56â†’\n    57â†’// Types for enriched data\n    58â†’interface EnrichedCheckout extends Werkzeugausgabe {\n    59â†’  werkzeugData?: Werkzeuge;\n    60â†’  mitarbeiterData?: Mitarbeiter;\n    61â†’  isOverdue: boolean;\n    62â†’  isDueToday: boolean;\n    63â†’  daysOverdue: number;\n    64â†’}\n    65â†’\n    66â†’interface RecentActivity {\n    67â†’  type: 'checkout' | 'return';\n    68â†’  werkzeugName: string;\n    69â†’  mitarbeiterName: string;\n    70â†’  date: string;\n    71â†’  timestamp: Date;\n    72â†’}\n    73â†’\n    74â†’// Loading skeleton component\n    75â†’function LoadingState() {\n    76â†’  return (\n    77â†’    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n    78â†’      <div className=\"max-w-7xl mx-auto space-y-6\">\n    79â†’        {/* Header skeleton */}\n    80â†’        <div className=\"flex justify-between items-center\">\n    81â†’          <Skeleton className=\"h-8 w-48\" />\n    82â†’          <Skeleton className=\"h-10 w-40\" />\n    83â†’        </div>\n    84â†’\n    85â†’        {/* Hero skeleton */}\n    86â†’        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n    87â†’\n    88â†’        {/* Content skeleton */}\n    89â†’        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n    90â†’          <div className=\"lg:col-span-2 space-y-4\">\n    91â†’            <Skeleton className=\"h-64 w-full rounded-xl\" />\n    92â†’          </div>\n    93â†’          <div className=\"space-y-4\">\n    94â†’            <Skeleton className=\"h-32 w-full rounded-xl\" />\n    95â†’            <Skeleton className=\"h-32 w-full rounded-xl\" />\n    96â†’            <Skeleton className=\"h-32 w-full rounded-xl\" />\n    97â†’          </div>\n    98â†’        </div>\n    99â†’      </div>\n   100â†’    </div>\n   101â†’  );\n   102â†’}\n   103â†’\n   104â†’// Error state component\n   105â†’function ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n   106â†’  return (\n   107â†’    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n   108â†’      <Alert variant=\"destructive\" className=\"max-w-md\">\n   109â†’        <AlertCircle className=\"h-4 w-4\" />\n   110â†’        <AlertTitle>Fehler beim Laden</AlertTitle>\n   111â†’        <AlertDescription className=\"mt-2\">\n   112â†’          <p className=\"mb-4\">{error.message}</p>\n   113â†’          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n   114â†’            <RefreshCw className=\"h-4 w-4 mr-2\" />\n   115â†’            Erneut versuchen\n   116â†’          </Button>\n   117â†’        </AlertDescription>\n   118â†’      </Alert>\n   119â†’    </div>\n   120â†’  );\n   121â†’}\n   122â†’\n   123â†’// Empty state component\n   124â†’function EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n   125â†’  return (\n   126â†’    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n   127â†’      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n   128â†’      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n   129â†’      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n   130â†’        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n   131â†’      </p>\n   132â†’      <Button onClick={onAddFirst}>\n   133â†’        <Plus className=\"h-4 w-4 mr-2\" />\n   134â†’        Werkzeug ausgeben\n   135â†’      </Button>\n   136â†’    </div>\n   137â†’  );\n   138â†’}\n   139â†’\n   140â†’// Checkout form component\n   141â†’function CheckoutForm({\n   142â†’  werkzeuge,\n   143â†’  mitarbeiter,\n   144â†’  activeCheckoutToolIds,\n   145â†’  onSubmit,\n   146â†’  onCancel,\n   147â†’  submitting,\n   148â†’}: {\n   149â†’  werkzeuge: Werkzeuge[];\n   150â†’  mitarbeiter: Mitarbeiter[];\n   151â†’  activeCheckoutToolIds: Set<string>;\n   152â†’  onSubmit: (data: {\n   153â†’    werkzeug: string;\n   154â†’    mitarbeiter: string;\n   155â†’    geplantes_rueckgabedatum: string;\n   156â†’    verwendungszweck?: string;\n   157â†’  }) => void;\n   158â†’  onCancel: () => void;\n   159â†’  submitting: boolean;\n   160â†’}) {\n   161â†’  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n   162â†’  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n   163â†’  const [rueckgabedatum, setRueckgabedatum] = useState('');\n   164â†’  const [verwendungszweck, setVerwendungszweck] = useState('');\n   165â†’\n   166â†’  // Filter to only show available tools (not currently checked out)\n   167â†’  const availableWerkzeuge = werkzeuge.filter(\n   168â†’    (w) => !activeCheckoutToolIds.has(w.record_id)\n   169â†’  );\n   170â†’\n   171â†’  const handleSubmit = (e: React.FormEvent) => {\n   172â†’    e.preventDefault();\n   173â†’    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n   174â†’\n   175â†’    onSubmit({\n   176â†’      werkzeug: selectedWerkzeug,\n   177â†’      mitarbeiter: selectedMitarbeiter,\n   178â†’      geplantes_rueckgabedatum: rueckgabedatum,\n   179â†’      verwendungszweck: verwendungszweck || undefined,\n   180â†’    });\n   181â†’  };\n   182â†’\n   183â†’  return (\n   184â†’    <form onSubmit={handleSubmit} className=\"space-y-4\">\n   185â†’      <div className=\"space-y-2\">\n   186â†’        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n   187â†’        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n   188â†’          <SelectTrigger>\n   189â†’            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n   190â†’          </SelectTrigger>\n   191â†’          <SelectContent>\n   192â†’            {availableWerkzeuge.length === 0 ? (\n   193â†’              <div className=\"p-2 text-sm text-muted-foreground\">\n   194â†’                Keine Werkzeuge verfÃ¼gbar\n   195â†’              </div>\n   196â†’            ) : (\n   197â†’              availableWerkzeuge.map((w) => (\n   198â†’                <SelectItem key={w.record_id} value={w.record_id}>\n   199â†’                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n   200â†’                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n   201â†’                </SelectItem>\n   202â†’              ))\n   203â†’            )}\n   204â†’          </SelectContent>\n   205â†’        </Select>\n   206â†’      </div>\n   207â†’\n   208â†’      <div className=\"space-y-2\">\n   209â†’        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n   210â†’        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n   211â†’          <SelectTrigger>\n   212â†’            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n   213â†’          </SelectTrigger>\n   214â†’          <SelectContent>\n   215â†’            {mitarbeiter.map((m) => (\n   216â†’              <SelectItem key={m.record_id} value={m.record_id}>\n   217â†’                {m.fields.vorname} {m.fields.nachname}\n   218â†’              </SelectItem>\n   219â†’            ))}\n   220â†’          </SelectContent>\n   221â†’        </Select>\n   222â†’      </div>\n   223â†’\n   224â†’      <div className=\"space-y-2\">\n   225â†’        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n   226â†’        <Input\n   227â†’          type=\"date\"\n   228â†’          id=\"rueckgabedatum\"\n   229â†’          value={rueckgabedatum}\n   230â†’          onChange={(e) => setRueckgabedatum(e.target.value)}\n   231â†’          min={format(new Date(), 'yyyy-MM-dd')}\n   232â†’          required\n   233â†’        />\n   234â†’      </div>\n   235â†’\n   236â†’      <div className=\"space-y-2\">\n   237â†’        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n   238â†’        <Textarea\n   239â†’          id=\"verwendungszweck\"\n   240â†’          value={verwendungszweck}\n   241â†’          onChange={(e) => setVerwendungszweck(e.target.value)}\n   242â†’          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n   243â†’          rows={3}\n   244â†’        />\n   245â†’      </div>\n   246â†’\n   247â†’      <div className=\"flex gap-3 pt-4\">\n   248â†’        <Button\n   249â†’          type=\"button\"\n   250â†’          variant=\"outline\"\n   251â†’          onClick={onCancel}\n   252â†’          className=\"flex-1\"\n   253â†’          disabled={submitting}\n   254â†’        >\n   255â†’          Abbrechen\n   256â†’        </Button>\n   257â†’        <Button\n   258â†’          type=\"submit\"\n   259â†’          className=\"flex-1\"\n   260â†’          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n   261â†’        >\n   262â†’          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n   263â†’        </Button>\n   264â†’      </div>\n   265â†’    </form>\n   266â†’  );\n   267â†’}\n   268â†’\n   269â†’// Return form component\n   270â†’function ReturnForm({\n   271â†’  checkout,\n   272â†’  onSubmit,\n   273â†’  onCancel,\n   274â†’  submitting,\n   275â†’}: {\n   276â†’  checkout: EnrichedCheckout;\n   277â†’  onSubmit: (data: {\n   278â†’    werkzeugausgabe: string;\n   279â†’    zustand_bei_rueckgabe: string;\n   280â†’    beschaedigungen?: string;\n   281â†’  }) => void;\n   282â†’  onCancel: () => void;\n   283â†’  submitting: boolean;\n   284â†’}) {\n   285â†’  const [zustand, setZustand] = useState('wie_ausgegeben');\n   286â†’  const [beschaedigungen, setBeschaedigungen] = useState('');\n   287â†’\n   288â†’  const handleSubmit = (e: React.FormEvent) => {\n   289â†’    e.preventDefault();\n   290â†’    onSubmit({\n   291â†’      werkzeugausgabe: checkout.record_id,\n   292â†’      zustand_bei_rueckgabe: zustand,\n   293â†’      beschaedigungen: beschaedigungen || undefined,\n   294â†’    });\n   295â†’  };\n   296â†’\n   297â†’  const zustandOptions = [\n   298â†’    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n   299â†’    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n   300â†’    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n   301â†’    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n   302â†’    { key: 'defekt', label: 'Defekt' },\n   303â†’  ];\n   304â†’\n   305â†’  return (\n   306â†’    <form onSubmit={handleSubmit} className=\"space-y-4\">\n   307â†’      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n   308â†’        <p className=\"font-medium\">\n   309â†’          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n   310â†’        </p>\n   311â†’        <p className=\"text-sm text-muted-foreground\">\n   312â†’          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n   313â†’          {checkout.mitarbeiterData?.fields.nachname}\n   314â†’        </p>\n   315â†’      </div>\n   316â†’\n   317â†’      <div className=\"space-y-2\">\n   318â†’        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n   319â†’        <Select value={zustand} onValueChange={setZustand}>\n   320â†’          <SelectTrigger>\n   321â†’            <SelectValue />\n   322â†’          </SelectTrigger>\n   323â†’          <SelectContent>\n   324â†’            {zustandOptions.map((opt) => (\n   325â†’              <SelectItem key={opt.key} value={opt.key}>\n   326â†’                {opt.label}\n   327â†’              </SelectItem>\n   328â†’            ))}\n   329â†’          </SelectContent>\n   330â†’        </Select>\n   331â†’      </div>\n   332â†’\n   333â†’      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n   334â†’        <div className=\"space-y-2\">\n   335â†’          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n   336â†’          <Textarea\n   337â†’            id=\"beschaedigungen\"\n   338â†’            value={beschaedigungen}\n   339â†’            onChange={(e) => setBeschaedigungen(e.target.value)}\n   340â†’            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n   341â†’            rows={3}\n   342â†’          />\n   343â†’        </div>\n   344â†’      )}\n   345â†’\n   346â†’      <div className=\"flex gap-3 pt-4\">\n   347â†’        <Button\n   348â†’          type=\"button\"\n   349â†’          variant=\"outline\"\n   350â†’          onClick={onCancel}\n   351â†’          className=\"flex-1\"\n   352â†’          disabled={submitting}\n   353â†’        >\n   354â†’          Abbrechen\n   355â†’        </Button>\n   356â†’        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n   357â†’          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n   358â†’        </Button>\n   359â†’      </div>\n   360â†’    </form>\n   361â†’  );\n   362â†’}\n   363â†’\n   364â†’// Main Dashboard component\n   365â†’export default function Dashboard() {\n   366â†’  // Data states\n   367â†’  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n   368â†’  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n   369â†’  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n   370â†’  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n   371â†’  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n   372â†’\n   373â†’  // UI states\n   374â†’  const [loading, setLoading] = useState(true);\n   375â†’  const [error, setError] = useState<Error | null>(null);\n   376â†’  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n   377â†’  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n   378â†’  const [submitting, setSubmitting] = useState(false);\n   379â†’\n   380â†’  // Fetch all data\n   381â†’  const fetchData = async () => {\n   382â†’    try {\n   383â†’      setLoading(true);\n   384â†’      setError(null);\n   385â†’      const [w, a, r, m, l] = await Promise.all([\n   386â†’        LivingAppsService.getWerkzeuge(),\n   387â†’        LivingAppsService.getWerkzeugausgabe(),\n   388â†’        LivingAppsService.getWerkzeugrueckgabe(),\n   389â†’        LivingAppsService.getMitarbeiter(),\n   390â†’        LivingAppsService.getLagerorte(),\n   391â†’      ]);\n   392â†’      setWerkzeuge(w);\n   393â†’      setAusgaben(a);\n   394â†’      setRueckgaben(r);\n   395â†’      setMitarbeiter(m);\n   396â†’      setLagerorte(l);\n   397â†’    } catch (err) {\n   398â†’      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n   399â†’    } finally {\n   400â†’      setLoading(false);\n   401â†’    }\n   402â†’  };\n   403â†’\n   404â†’  useEffect(() => {\n   405â†’    fetchData();\n   406â†’  }, []);\n   407â†’\n   408â†’  // Create lookup maps\n   409â†’  const werkzeugeMap = useMemo(() => {\n   410â†’    const map = new Map<string, Werkzeuge>();\n   411â†’    werkzeuge.forEach((w) => map.set(w.record_id, w));\n   412â†’    return map;\n   413â†’  }, [werkzeuge]);\n   414â†’\n   415â†’  const mitarbeiterMap = useMemo(() => {\n   416â†’    const map = new Map<string, Mitarbeiter>();\n   417â†’    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n   418â†’    return map;\n   419â†’  }, [mitarbeiter]);\n   420â†’\n   421â†’  // Get IDs of returned checkouts\n   422â†’  const returnedCheckoutIds = useMemo(() => {\n   423â†’    const ids = new Set<string>();\n   424â†’    rueckgaben.forEach((r) => {\n   425â†’      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n   426â†’      if (checkoutId) ids.add(checkoutId);\n   427â†’    });\n   428â†’    return ids;\n   429â†’  }, [rueckgaben]);\n   430â†’\n   431â†’  // Get active checkouts (not returned)\n   432â†’  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n   433â†’    const today = new Date();\n   434â†’    today.setHours(0, 0, 0, 0);\n   435â†’\n   436â†’    return ausgaben\n   437â†’      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n   438â†’      .map((a) => {\n   439â†’        const werkzeugId = extractRecordId(a.fields.werkzeug);\n   440â†’        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n   441â†’\n   442â†’        const plannedReturn = a.fields.geplantes_rueckgabedatum\n   443â†’          ? parseISO(a.fields.geplantes_rueckgabedatum)\n   444â†’          : null;\n   445â†’\n   446â†’        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n   447â†’        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n   448â†’        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n   449â†’\n   450â†’        return {\n   451â†’          ...a,\n   452â†’          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n   453â†’          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n   454â†’          isOverdue,\n   455â†’          isDueToday,\n   456â†’          daysOverdue,\n   457â†’        };\n   458â†’      })\n   459â†’      .sort((a, b) => {\n   460â†’        // Sort: overdue first, then due today, then by planned return date\n   461â†’        if (a.isOverdue && !b.isOverdue) return -1;\n   462â†’        if (!a.isOverdue && b.isOverdue) return 1;\n   463â†’        if (a.isDueToday && !b.isDueToday) return -1;\n   464â†’        if (!a.isDueToday && b.isDueToday) return 1;\n   465â†’\n   466â†’        const dateA = a.fields.geplantes_rueckgabedatum || '';\n   467â†’        const dateB = b.fields.geplantes_rueckgabedatum || '';\n   468â†’        return dateA.localeCompare(dateB);\n   469â†’      });\n   470â†’  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n   471â†’\n   472â†’  // IDs of currently checked-out tools\n   473â†’  const activeCheckoutToolIds = useMemo(() => {\n   474â†’    const ids = new Set<string>();\n   475â†’    activeCheckouts.forEach((c) => {\n   476â†’      const toolId = extractRecordId(c.fields.werkzeug);\n   477â†’      if (toolId) ids.add(toolId);\n   478â†’    });\n   479â†’    return ids;\n   480â†’  }, [activeCheckouts]);\n   481â†’\n   482â†’  // Overdue and due-today counts\n   483â†’  const overdueCheckouts = useMemo(\n   484â†’    () => activeCheckouts.filter((c) => c.isOverdue),\n   485â†’    [activeCheckouts]\n   486â†’  );\n   487â†’  const dueTodayCheckouts = useMemo(\n   488â†’    () => activeCheckouts.filter((c) => c.isDueToday),\n   489â†’    [activeCheckouts]\n   490â†’  );\n   491â†’\n   492â†’  // Tools needing maintenance\n   493â†’  const toolsNeedingMaintenance = useMemo(() => {\n   494â†’    const today = new Date();\n   495â†’    const twoWeeksFromNow = new Date(today);\n   496â†’    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n   497â†’\n   498â†’    return werkzeuge\n   499â†’      .filter((w) => {\n   500â†’        if (!w.fields.naechste_wartung) return false;\n   501â†’        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n   502â†’        return isBefore(maintenanceDate, twoWeeksFromNow);\n   503â†’      })\n   504â†’      .sort((a, b) => {\n   505â†’        const dateA = a.fields.naechste_wartung || '';\n   506â†’        const dateB = b.fields.naechste_wartung || '';\n   507â†’        return dateA.localeCompare(dateB);\n   508â†’      });\n   509â†’  }, [werkzeuge]);\n   510â†’\n   511â†’  // Tool conditions breakdown\n   512â†’  const conditionBreakdown = useMemo(() => {\n   513â†’    const counts: Record<string, number> = {\n   514â†’      neu: 0,\n   515â†’      sehr_gut: 0,\n   516â†’      gut: 0,\n   517â†’      befriedigend: 0,\n   518â†’      ausreichend: 0,\n   519â†’      defekt: 0,\n   520â†’    };\n   521â†’    werkzeuge.forEach((w) => {\n   522â†’      const condition = w.fields.zustand || 'gut';\n   523â†’      if (condition in counts) {\n   524â†’        counts[condition]++;\n   525â†’      }\n   526â†’    });\n   527â†’    return counts;\n   528â†’  }, [werkzeuge]);\n   529â†’\n   530â†’  // Recent activity\n   531â†’  const recentActivity = useMemo<RecentActivity[]>(() => {\n   532â†’    const activities: RecentActivity[] = [];\n   533â†’\n   534â†’    // Add checkouts\n   535â†’    ausgaben.forEach((a) => {\n   536â†’      const werkzeugId = extractRecordId(a.fields.werkzeug);\n   537â†’      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n   538â†’      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n   539â†’      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n   540â†’\n   541â†’      activities.push({\n   542â†’        type: 'checkout',\n   543â†’        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n   544â†’        mitarbeiterName: mitarbeiterData\n   545â†’          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n   546â†’          : 'Unbekannt',\n   547â†’        date: a.createdat,\n   548â†’        timestamp: parseISO(a.createdat),\n   549â†’      });\n   550â†’    });\n   551â†’\n   552â†’    // Add returns\n   553â†’    rueckgaben.forEach((r) => {\n   554â†’      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n   555â†’      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n   556â†’\n   557â†’      if (checkout) {\n   558â†’        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n   559â†’        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n   560â†’        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n   561â†’        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n   562â†’\n   563â†’        activities.push({\n   564â†’          type: 'return',\n   565â†’          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n   566â†’          mitarbeiterName: mitarbeiterData\n   567â†’            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n   568â†’            : 'Unbekannt',\n   569â†’          date: r.createdat,\n   570â†’          timestamp: parseISO(r.createdat),\n   571â†’        });\n   572â†’      }\n   573â†’    });\n   574â†’\n   575â†’    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n   576â†’  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n   577â†’\n   578â†’  // Tools per location\n   579â†’  const toolsPerLocation = useMemo(() => {\n   580â†’    const counts = new Map<string, number>();\n   581â†’    werkzeuge.forEach((w) => {\n   582â†’      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n   583â†’      if (locationId) {\n   584â†’        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n   585â†’      }\n   586â†’    });\n   587â†’    return counts;\n   588â†’  }, [werkzeuge]);\n   589â†’\n   590â†’  // Handle checkout submission\n   591â†’  const handleCheckoutSubmit = async (data: {\n   592â†’    werkzeug: string;\n   593â†’    mitarbeiter: string;\n   594â†’    geplantes_rueckgabedatum: string;\n   595â†’    verwendungszweck?: string;\n   596â†’  }) => {\n   597â†’    try {\n   598â†’      setSubmitting(true);\n   599â†’      const now = new Date();\n   600â†’      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n   601â†’\n   602â†’      await LivingAppsService.createWerkzeugausgabeEntry({\n   603â†’        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n   604â†’        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n   605â†’        ausgabedatum,\n   606â†’        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n   607â†’        verwendungszweck: data.verwendungszweck,\n   608â†’      });\n   609â†’\n   610â†’      setCheckoutDialogOpen(false);\n   611â†’      await fetchData();\n   612â†’    } catch (err) {\n   613â†’      console.error('Checkout failed:', err);\n   614â†’      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n   615â†’    } finally {\n   616â†’      setSubmitting(false);\n   617â†’    }\n   618â†’  };\n   619â†’\n   620â†’  // Handle return submission\n   621â†’  const handleReturnSubmit = async (data: {\n   622â†’    werkzeugausgabe: string;\n   623â†’    zustand_bei_rueckgabe: string;\n   624â†’    beschaedigungen?: string;\n   625â†’  }) => {\n   626â†’    try {\n   627â†’      setSubmitting(true);\n   628â†’      const now = new Date();\n   629â†’      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n   630â†’\n   631â†’      await LivingAppsService.createWerkzeugrueckgabeEntry({\n   632â†’        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n   633â†’        rueckgabedatum,\n   634â†’        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n   635â†’        beschaedigungen: data.beschaedigungen,\n   636â†’      });\n   637â†’\n   638â†’      setSelectedCheckout(null);\n   639â†’      await fetchData();\n   640â†’    } catch (err) {\n   641â†’      console.error('Return failed:', err);\n   642â†’      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n   643â†’    } finally {\n   644â†’      setSubmitting(false);\n   645â†’    }\n   646â†’  };\n   647â†’\n   648â†’  // Get initials for employee badge\n   649â†’  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n   650â†’    if (!mitarbeiterData) return '??';\n   651â†’    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n   652â†’    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n   653â†’    return `${first}${last}`.toUpperCase();\n   654â†’  };\n   655â†’\n   656â†’  // Loading state\n   657â†’  if (loading) return <LoadingState />;\n   658â†’\n   659â†’  // Error state\n   660â†’  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n   661â†’\n   662â†’  return (\n   663â†’    <div className=\"min-h-screen bg-background\">\n   664â†’      {/* Header - Desktop */}\n   665â†’      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n   666â†’        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n   667â†’        <div className=\"flex items-center gap-4\">\n   668â†’          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n   669â†’            <DialogTrigger asChild>\n   670â†’              <Button className=\"gap-2\">\n   671â†’                <Plus className=\"h-4 w-4\" />\n   672â†’                Werkzeug ausgeben\n   673â†’              </Button>\n   674â†’            </DialogTrigger>\n   675â†’            <DialogContent className=\"sm:max-w-md\">\n   676â†’              <DialogHeader>\n   677â†’                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n   678â†’              </DialogHeader>\n   679â†’              <CheckoutForm\n   680â†’                werkzeuge={werkzeuge}\n   681â†’                mitarbeiter={mitarbeiter}\n   682â†’                activeCheckoutToolIds={activeCheckoutToolIds}\n   683â†’                onSubmit={handleCheckoutSubmit}\n   684â†’                onCancel={() => setCheckoutDialogOpen(false)}\n   685â†’                submitting={submitting}\n   686â†’              />\n   687â†’            </DialogContent>\n   688â†’          </Dialog>\n   689â†’        </div>\n   690â†’      </header>\n   691â†’\n   692â†’      {/* Header - Mobile */}\n   693â†’      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n   694â†’        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n   695â†’        <Badge variant=\"secondary\" className=\"text-xs\">\n   696â†’          {werkzeuge.length} Werkzeuge\n   697â†’        </Badge>\n   698â†’      </header>\n   699â†’\n   700â†’      {/* Main Content */}\n   701â†’      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n   702â†’        <div className=\"max-w-7xl mx-auto\">\n   703â†’          {/* Desktop Layout: 65/35 split */}\n   704â†’          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n   705â†’            {/* Left Column - Main Content */}\n   706â†’            <div className=\"space-y-6\">\n   707â†’              {/* Hero Card */}\n   708â†’              <Card className=\"border-0 shadow-sm\">\n   709â†’                <CardContent className=\"p-6 md:p-8\">\n   710â†’                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n   711â†’                    <div className=\"flex flex-col items-center md:items-start\">\n   712â†’                      <span\n   713â†’                        className=\"text-7xl font-bold tabular-nums\"\n   714â†’                        style={{ color: 'hsl(38 92% 50%)' }}\n   715â†’                      >\n   716â†’                        {activeCheckouts.length}\n   717â†’                      </span>\n   718â†’                      <span className=\"text-muted-foreground text-sm mt-1\">\n   719â†’                        Werkzeuge ausgeliehen\n   720â†’                      </span>\n   721â†’                    </div>\n   722â†’                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n   723â†’                      {overdueCheckouts.length > 0 && (\n   724â†’                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n   725â†’                          <AlertCircle className=\"h-3.5 w-3.5\" />\n   726â†’                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n   727â†’                        </Badge>\n   728â†’                      )}\n   729â†’                      {dueTodayCheckouts.length > 0 && (\n   730â†’                        <Badge\n   731â†’                          className=\"gap-1.5 py-1.5 px-3\"\n   732â†’                          style={{\n   733â†’                            backgroundColor: 'hsl(38 92% 95%)',\n   734â†’                            color: 'hsl(38 92% 35%)',\n   735â†’                          }}\n   736â†’                        >\n   737â†’                          <Clock className=\"h-3.5 w-3.5\" />\n   738â†’                          {dueTodayCheckouts.length} heute fÃ¤llig\n   739â†’                        </Badge>\n   740â†’                      )}\n   741â†’                    </div>\n   742â†’                  </div>\n   743â†’                </CardContent>\n   744â†’              </Card>\n   745â†’\n   746â†’              {/* Overdue Section */}\n   747â†’              {overdueCheckouts.length > 0 && (\n   748â†’                <Card className=\"border-destructive/50 bg-destructive/5\">\n   749â†’                  <CardHeader className=\"pb-3\">\n   750â†’                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n   751â†’                      <AlertCircle className=\"h-4 w-4\" />\n   752â†’                      ÃœberfÃ¤llige RÃ¼ckgaben\n   753â†’                    </CardTitle>\n   754â†’                  </CardHeader>\n   755â†’                  <CardContent className=\"pt-0\">\n   756â†’                    <div className=\"space-y-2\">\n   757â†’                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n   758â†’                        <div\n   759â†’                          key={checkout.record_id}\n   760â†’                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n   761â†’                          onClick={() => setSelectedCheckout(checkout)}\n   762â†’                        >\n   763â†’                          <div className=\"flex items-center gap-3\">\n   764â†’                            <div\n   765â†’                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n   766â†’                              style={{\n   767â†’                                backgroundColor: 'hsl(38 92% 95%)',\n   768â†’                                color: 'hsl(38 92% 35%)',\n   769â†’                              }}\n   770â†’                            >\n   771â†’                              {getInitials(checkout.mitarbeiterData)}\n   772â†’                            </div>\n   773â†’                            <div>\n   774â†’                              <p className=\"font-medium text-sm\">\n   775â†’                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n   776â†’                              </p>\n   777â†’                              <p className=\"text-xs text-muted-foreground\">\n   778â†’                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n   779â†’                                {checkout.mitarbeiterData?.fields.nachname}\n   780â†’                              </p>\n   781â†’                            </div>\n   782â†’                          </div>\n   783â†’                          <Badge variant=\"destructive\" className=\"text-xs\">\n   784â†’                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n   785â†’                          </Badge>\n   786â†’                        </div>\n   787â†’                      ))}\n   788â†’                      {overdueCheckouts.length > 3 && (\n   789â†’                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n   790â†’                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n   791â†’                        </p>\n   792â†’                      )}\n   793â†’                    </div>\n   794â†’                  </CardContent>\n   795â†’                </Card>\n   796â†’              )}\n   797â†’\n   798â†’              {/* Active Checkouts List */}\n   799â†’              <Card className=\"border-0 shadow-sm\">\n   800â†’                <CardHeader className=\"pb-3\">\n   801â†’                  <div className=\"flex items-center justify-between\">\n   802â†’                    <CardTitle className=\"text-base flex items-center gap-2\">\n   803â†’                      <Wrench className=\"h-4 w-4\" />\n   804â†’                      Ausgeliehen\n   805â†’                      <Badge variant=\"secondary\" className=\"ml-1\">\n   806â†’                        {activeCheckouts.length}\n   807â†’                      </Badge>\n   808â†’                    </CardTitle>\n   809â†’                  </div>\n   810â†’                </CardHeader>\n   811â†’                <CardContent className=\"pt-0\">\n   812â†’                  {activeCheckouts.length === 0 ? (\n   813â†’                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n   814â†’                  ) : (\n   815â†’                    <>\n   816â†’                      {/* Mobile: Card list */}\n   817â†’                      <div className=\"md:hidden space-y-3\">\n   818â†’                        {activeCheckouts.map((checkout) => (\n   819â†’                          <div\n   820â†’                            key={checkout.record_id}\n   821â†’                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n   822â†’                            onClick={() => setSelectedCheckout(checkout)}\n   823â†’                          >\n   824â†’                            <div className=\"flex items-start justify-between mb-2\">\n   825â†’                              <div className=\"flex items-center gap-3\">\n   826â†’                                <div\n   827â†’                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n   828â†’                                  style={{\n   829â†’                                    backgroundColor: 'hsl(38 92% 95%)',\n   830â†’                                    color: 'hsl(38 92% 35%)',\n   831â†’                                  }}\n   832â†’                                >\n   833â†’                                  {getInitials(checkout.mitarbeiterData)}\n   834â†’                                </div>\n   835â†’                                <div>\n   836â†’                                  <p className=\"font-semibold\">\n   837â†’                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n   838â†’                                  </p>\n   839â†’                                  <p className=\"text-sm text-muted-foreground\">\n   840â†’                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n   841â†’                                    {checkout.mitarbeiterData?.fields.nachname}\n   842â†’                                  </p>\n   843â†’                                </div>\n   844â†’                              </div>\n   845â†’                              {checkout.isOverdue ? (\n   846â†’                                <Badge variant=\"destructive\" className=\"text-xs\">\n   847â†’                                  ÃœberfÃ¤llig\n   848â†’                                </Badge>\n   849â†’                              ) : checkout.isDueToday ? (\n   850â†’                                <Badge\n   851â†’                                  className=\"text-xs\"\n   852â†’                                  style={{\n   853â†’                                    backgroundColor: 'hsl(38 92% 95%)',\n   854â†’                                    color: 'hsl(38 92% 35%)',\n   855â†’                                  }}\n   856â†’                                >\n   857â†’                                  Heute\n   858â†’                                </Badge>\n   859â†’                              ) : (\n   860â†’                                <div\n   861â†’                                  className=\"w-2.5 h-2.5 rounded-full\"\n   862â†’                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n   863â†’                                />\n   864â†’                              )}\n   865â†’                            </div>\n   866â†’                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n   867â†’                              <span className=\"flex items-center gap-1\">\n   868â†’                                <CalendarDays className=\"h-3 w-3\" />\n   869â†’                                {checkout.fields.ausgabedatum\n   870â†’                                  ? format(\n   871â†’                                      parseISO(checkout.fields.ausgabedatum),\n   872â†’                                      'dd.MM.yyyy',\n   873â†’                                      { locale: de }\n   874â†’                                    )\n   875â†’                                  : '-'}\n   876â†’                              </span>\n   877â†’                              <ArrowRight className=\"h-3 w-3\" />\n   878â†’                              <span>\n   879â†’                                {checkout.fields.geplantes_rueckgabedatum\n   880â†’                                  ? format(\n   881â†’                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n   882â†’                                      'dd.MM.yyyy',\n   883â†’                                      { locale: de }\n   884â†’                                    )\n   885â†’                                  : '-'}\n   886â†’                              </span>\n   887â†’                            </div>\n   888â†’                          </div>\n   889â†’                        ))}\n   890â†’                      </div>\n   891â†’\n   892â†’                      {/* Desktop: Table */}\n   893â†’                      <div className=\"hidden md:block\">\n   894â†’                        <Table>\n   895â†’                          <TableHeader>\n   896â†’                            <TableRow>\n   897â†’                              <TableHead>Werkzeug</TableHead>\n   898â†’                              <TableHead>Mitarbeiter</TableHead>\n   899â†’                              <TableHead>Ausgabedatum</TableHead>\n   900â†’                              <TableHead>RÃ¼ckgabe bis</TableHead>\n   901â†’                              <TableHead className=\"text-right\">Status</TableHead>\n   902â†’                            </TableRow>\n   903â†’                          </TableHeader>\n   904â†’                          <TableBody>\n   905â†’                            {activeCheckouts.map((checkout) => (\n   906â†’                              <TableRow\n   907â†’                                key={checkout.record_id}\n   908â†’                                className=\"cursor-pointer hover:bg-muted/50\"\n   909â†’                                onClick={() => setSelectedCheckout(checkout)}\n   910â†’                              >\n   911â†’                                <TableCell className=\"font-medium\">\n   912â†’                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n   913â†’                                </TableCell>\n   914â†’                                <TableCell>\n   915â†’                                  <div className=\"flex items-center gap-2\">\n   916â†’                                    <div\n   917â†’                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n   918â†’                                      style={{\n   919â†’                                        backgroundColor: 'hsl(38 92% 95%)',\n   920â†’                                        color: 'hsl(38 92% 35%)',\n   921â†’                                      }}\n   922â†’                                    >\n   923â†’                                      {getInitials(checkout.mitarbeiterData)}\n   924â†’                                    </div>\n   925â†’                                    <span>\n   926â†’                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n   927â†’                                      {checkout.mitarbeiterData?.fields.nachname}\n   928â†’                                    </span>\n   929â†’                                  </div>\n   930â†’                                </TableCell>\n   931â†’                                <TableCell>\n   932â†’                                  {checkout.fields.ausgabedatum\n   933â†’                                    ? format(\n   934â†’                                        parseISO(checkout.fields.ausgabedatum),\n   935â†’                                        'dd.MM.yyyy',\n   936â†’                                        { locale: de }\n   937â†’                                      )\n   938â†’                                    : '-'}\n   939â†’                                </TableCell>\n   940â†’                                <TableCell>\n   941â†’                                  {checkout.fields.geplantes_rueckgabedatum\n   942â†’                                    ? format(\n   943â†’                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n   944â†’                                        'dd.MM.yyyy',\n   945â†’                                        { locale: de }\n   946â†’                                      )\n   947â†’                                    : '-'}\n   948â†’                                </TableCell>\n   949â†’                                <TableCell className=\"text-right\">\n   950â†’                                  {checkout.isOverdue ? (\n   951â†’                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n   952â†’                                  ) : checkout.isDueToday ? (\n   953â†’                                    <Badge\n   954â†’                                      style={{\n   955â†’                                        backgroundColor: 'hsl(38 92% 95%)',\n   956â†’                                        color: 'hsl(38 92% 35%)',\n   957â†’                                      }}\n   958â†’                                    >\n   959â†’                                      Heute fÃ¤llig\n   960â†’                                    </Badge>\n   961â†’                                  ) : (\n   962â†’                                    <div className=\"flex items-center justify-end gap-2\">\n   963â†’                                      <div\n   964â†’                                        className=\"w-2 h-2 rounded-full\"\n   965â†’                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n   966â†’                                      />\n   967â†’                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n   968â†’                                    </div>\n   969â†’                                  )}\n   970â†’                                </TableCell>\n   971â†’                              </TableRow>\n   972â†’                            ))}\n   973â†’                          </TableBody>\n   974â†’                        </Table>\n   975â†’                      </div>\n   976â†’                    </>\n   977â†’                  )}\n   978â†’                </CardContent>\n   979â†’              </Card>\n   980â†’            </div>\n   981â†’\n   982â†’            {/* Right Column - Stats Sidebar (Desktop) */}\n   983â†’            <div className=\"hidden lg:flex flex-col gap-4\">\n   984â†’              {/* Tools Overview */}\n   985â†’              <Card className=\"border-0 shadow-sm\">\n   986â†’                <CardHeader className=\"pb-2\">\n   987â†’                  <CardTitle className=\"text-base flex items-center gap-2\">\n   988â†’                    <Package className=\"h-4 w-4\" />\n   989â†’                    Werkzeuge Ãœbersicht\n   990â†’                  </CardTitle>\n   991â†’                </CardHeader>\n   992â†’                <CardContent>\n   993â†’                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n   994â†’                  <div className=\"flex flex-wrap gap-2 text-xs\">\n   995â†’                    <span className=\"px-2 py-1 rounded bg-muted\">\n   996â†’                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n   997â†’                    </span>\n   998â†’                    <span className=\"px-2 py-1 rounded bg-muted\">\n   999â†’                      Gut: {conditionBreakdown.gut}\n  1000â†’                    </span>\n  1001â†’                    <span className=\"px-2 py-1 rounded bg-muted\">\n  1002â†’                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n  1003â†’                    </span>\n  1004â†’                    <span\n  1005â†’                      className=\"px-2 py-1 rounded\"\n  1006â†’                      style={{\n  1007â†’                        backgroundColor: 'hsl(0 84% 95%)',\n  1008â†’                        color: 'hsl(0 84% 40%)',\n  1009â†’                      }}\n  1010â†’                    >\n  1011â†’                      Defekt: {conditionBreakdown.defekt}\n  1012â†’                    </span>\n  1013â†’                  </div>\n  1014â†’                </CardContent>\n  1015â†’              </Card>\n  1016â†’\n  1017â†’              {/* Maintenance Due */}\n  1018â†’              <Card className=\"border-0 shadow-sm\">\n  1019â†’                <CardHeader className=\"pb-2\">\n  1020â†’                  <CardTitle className=\"text-base flex items-center gap-2\">\n  1021â†’                    <Settings className=\"h-4 w-4\" />\n  1022â†’                    Wartung fÃ¤llig\n  1023â†’                  </CardTitle>\n  1024â†’                </CardHeader>\n  1025â†’                <CardContent>\n  1026â†’                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n  1027â†’                  {toolsNeedingMaintenance.length > 0 ? (\n  1028â†’                    <div className=\"space-y-2\">\n  1029â†’                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n  1030â†’                        <div\n  1031â†’                          key={tool.record_id}\n  1032â†’                          className=\"flex items-center justify-between text-sm\"\n  1033â†’                        >\n  1034â†’                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n  1035â†’                          <span className=\"text-muted-foreground text-xs\">\n  1036â†’                            {tool.fields.naechste_wartung\n  1037â†’                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n  1038â†’                                  locale: de,\n  1039â†’                                })\n  1040â†’                              : '-'}\n  1041â†’                          </span>\n  1042â†’                        </div>\n  1043â†’                      ))}\n  1044â†’                    </div>\n  1045â†’                  ) : (\n  1046â†’                    <p className=\"text-sm text-muted-foreground\">\n  1047â†’                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n  1048â†’                    </p>\n  1049â†’                  )}\n  1050â†’                </CardContent>\n  1051â†’              </Card>\n  1052â†’\n  1053â†’              {/* Storage Locations */}\n  1054â†’              <Card className=\"border-0 shadow-sm\">\n  1055â†’                <CardHeader className=\"pb-2\">\n  1056â†’                  <CardTitle className=\"text-base flex items-center gap-2\">\n  1057â†’                    <MapPin className=\"h-4 w-4\" />\n  1058â†’                    Lagerorte\n  1059â†’                  </CardTitle>\n  1060â†’                </CardHeader>\n  1061â†’                <CardContent>\n  1062â†’                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n  1063â†’                  <div className=\"space-y-2\">\n  1064â†’                    {lagerorte.slice(0, 4).map((loc) => (\n  1065â†’                      <div\n  1066â†’                        key={loc.record_id}\n  1067â†’                        className=\"flex items-center justify-between text-sm\"\n  1068â†’                      >\n  1069â†’                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n  1070â†’                        <Badge variant=\"secondary\" className=\"text-xs\">\n  1071â†’                          {toolsPerLocation.get(loc.record_id) || 0}\n  1072â†’                        </Badge>\n  1073â†’                      </div>\n  1074â†’                    ))}\n  1075â†’                  </div>\n  1076â†’                </CardContent>\n  1077â†’              </Card>\n  1078â†’\n  1079â†’              {/* Recent Activity */}\n  1080â†’              <Card className=\"border-0 shadow-sm\">\n  1081â†’                <CardHeader className=\"pb-2\">\n  1082â†’                  <CardTitle className=\"text-base flex items-center gap-2\">\n  1083â†’                    <Clock className=\"h-4 w-4\" />\n  1084â†’                    AktivitÃ¤t\n  1085â†’                  </CardTitle>\n  1086â†’                </CardHeader>\n  1087â†’                <CardContent>\n  1088â†’                  {recentActivity.length > 0 ? (\n  1089â†’                    <div className=\"space-y-3\">\n  1090â†’                      {recentActivity.map((activity, idx) => (\n  1091â†’                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n  1092â†’                          <div\n  1093â†’                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n  1094â†’                              activity.type === 'checkout'\n  1095â†’                                ? 'bg-amber-500'\n  1096â†’                                : 'bg-green-500'\n  1097â†’                            }`}\n  1098â†’                          />\n  1099â†’                          <div className=\"min-w-0\">\n  1100â†’                            <p className=\"truncate\">\n  1101â†’                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n  1102â†’                              <span className=\"text-muted-foreground\">\n  1103â†’                                {' â†’ '}\n  1104â†’                                {activity.mitarbeiterName}\n  1105â†’                              </span>\n  1106â†’                            </p>\n  1107â†’                            <p className=\"text-xs text-muted-foreground\">\n  1108â†’                              {formatDistance(activity.timestamp, new Date(), {\n  1109â†’                                addSuffix: true,\n  1110â†’                                locale: de,\n  1111â†’                              })}\n  1112â†’                            </p>\n  1113â†’                          </div>\n  1114â†’                        </div>\n  1115â†’                      ))}\n  1116â†’                    </div>\n  1117â†’                  ) : (\n  1118â†’                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n  1119â†’                  )}\n  1120â†’                </CardContent>\n  1121â†’              </Card>\n  1122â†’            </div>\n  1123â†’          </div>\n  1124â†’\n  1125â†’          {/* Mobile: Quick Stats Row */}\n  1126â†’          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n  1127â†’            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n  1128â†’              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n  1129â†’                <Package className=\"h-5 w-5 text-muted-foreground\" />\n  1130â†’                <div>\n  1131â†’                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n  1132â†’                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n  1133â†’                </div>\n  1134â†’              </div>\n  1135â†’              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n  1136â†’                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n  1137â†’                <div>\n  1138â†’                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n  1139â†’                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n  1140â†’                </div>\n  1141â†’              </div>\n  1142â†’              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n  1143â†’                <Users className=\"h-5 w-5 text-muted-foreground\" />\n  1144â†’                <div>\n  1145â†’                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n  1146â†’                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n  1147â†’                </div>\n  1148â†’              </div>\n  1149â†’              {toolsNeedingMaintenance.length > 0 && (\n  1150â†’                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n  1151â†’                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n  1152â†’                  <div>\n  1153â†’                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n  1154â†’                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n  1155â†’                  </div>\n  1156â†’                </div>\n  1157â†’              )}\n  1158â†’            </div>\n  1159â†’          </div>\n  1160â†’        </div>\n  1161â†’      </main>\n  1162â†’\n  1163â†’      {/* Mobile: Fixed Bottom Action Button */}\n  1164â†’      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n  1165â†’        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n  1166â†’          <DialogTrigger asChild>\n  1167â†’            <Button className=\"w-full h-14 text-base gap-2\">\n  1168â†’              <Plus className=\"h-5 w-5\" />\n  1169â†’              Werkzeug ausgeben\n  1170â†’            </Button>\n  1171â†’          </DialogTrigger>\n  1172â†’          <DialogContent className=\"sm:max-w-md\">\n  1173â†’            <DialogHeader>\n  1174â†’              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n  1175â†’            </DialogHeader>\n  1176â†’            <CheckoutForm\n  1177â†’              werkzeuge={werkzeuge}\n  1178â†’              mitarbeiter={mitarbeiter}\n  1179â†’              activeCheckoutToolIds={activeCheckoutToolIds}\n  1180â†’              onSubmit={handleCheckoutSubmit}\n  1181â†’              onCancel={() => setCheckoutDialogOpen(false)}\n  1182â†’              submitting={submitting}\n  1183â†’            />\n  1184â†’          </DialogContent>\n  1185â†’        </Dialog>\n  1186â†’      </div>\n  1187â†’\n  1188â†’      {/* Detail Sheet for checkout/return */}\n  1189â†’      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n  1190â†’        <SheetContent className=\"sm:max-w-md\">\n  1191â†’          <SheetHeader>\n  1192â†’            <SheetTitle>\n  1193â†’              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n  1194â†’            </SheetTitle>\n  1195â†’          </SheetHeader>\n  1196â†’\n  1197â†’          {selectedCheckout && (\n  1198â†’            <div className=\"mt-6 space-y-6\">\n  1199â†’              {/* Tool Info */}\n  1200â†’              <div className=\"space-y-4\">\n  1201â†’                <div>\n  1202â†’                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n  1203â†’                  <p className=\"font-medium\">\n  1204â†’                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n  1205â†’                  </p>\n  1206â†’                </div>\n  1207â†’                <div>\n  1208â†’                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n  1209â†’                  <p className=\"font-medium\">\n  1210â†’                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n  1211â†’                  </p>\n  1212â†’                </div>\n  1213â†’                <div>\n  1214â†’                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n  1215â†’                  <p className=\"font-medium\">\n  1216â†’                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n  1217â†’                  </p>\n  1218â†’                </div>\n  1219â†’              </div>\n  1220â†’\n  1221â†’              <hr className=\"border-border\" />\n  1222â†’\n  1223â†’              {/* Checkout Info */}\n  1224â†’              <div className=\"space-y-4\">\n  1225â†’                <div>\n  1226â†’                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n  1227â†’                  <p className=\"font-medium\">\n  1228â†’                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n  1229â†’                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n  1230â†’                  </p>\n  1231â†’                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n  1232â†’                    <p className=\"text-sm text-muted-foreground\">\n  1233â†’                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n  1234â†’                    </p>\n  1235â†’                  )}\n  1236â†’                </div>\n  1237â†’                <div>\n  1238â†’                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n  1239â†’                  <p className=\"font-medium\">\n  1240â†’                    {selectedCheckout.fields.ausgabedatum\n  1241â†’                      ? format(\n  1242â†’                          parseISO(selectedCheckout.fields.ausgabedatum),\n  1243â†’                          'PPP',\n  1244â†’                          { locale: de }\n  1245â†’                        )\n  1246â†’                      : '-'}\n  1247â†’                  </p>\n  1248â†’                </div>\n  1249â†’                <div>\n  1250â†’                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n  1251â†’                  <p\n  1252â†’                    className={`font-medium ${\n  1253â†’                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n  1254â†’                    }`}\n  1255â†’                  >\n  1256â†’                    {selectedCheckout.fields.geplantes_rueckgabedatum\n  1257â†’                      ? format(\n  1258â†’                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n  1259â†’                          'PPP',\n  1260â†’                          { locale: de }\n  1261â†’                        )\n  1262â†’                      : '-'}\n  1263â†’                    {selectedCheckout.isOverdue && (\n  1264â†’                      <span className=\"ml-2 text-sm\">\n  1265â†’                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n  1266â†’                      </span>\n  1267â†’                    )}\n  1268â†’                  </p>\n  1269â†’                </div>\n  1270â†’                {selectedCheckout.fields.verwendungszweck && (\n  1271â†’                  <div>\n  1272â†’                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n  1273â†’                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n  1274â†’                  </div>\n  1275â†’                )}\n  1276â†’              </div>\n  1277â†’\n  1278â†’              <hr className=\"border-border\" />\n  1279â†’\n  1280â†’              {/* Return Form */}\n  1281â†’              <div>\n  1282â†’                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n  1283â†’                <ReturnForm\n  1284â†’                  checkout={selectedCheckout}\n  1285â†’                  onSubmit={handleReturnSubmit}\n  1286â†’                  onCancel={() => setSelectedCheckout(null)}\n  1287â†’                  submitting={submitting}\n  1288â†’                />\n  1289â†’              </div>\n  1290â†’            </div>\n  1291â†’          )}\n  1292â†’        </SheetContent>\n  1293â†’      </Sheet>\n  1294â†’    </div>\n  1295â†’  );\n  1296â†’}\n  1297â†’\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"b9ff44be-b48a-4600-995f-250ccbc00bb4","timestamp":"2026-02-06T12:34:19.437Z","toolUseResult":{"type":"text","file":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","content":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","numLines":1297,"startLine":1,"totalLines":1297}}}
{"parentUuid":"b9ff44be-b48a-4600-995f-250ccbc00bb4","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_0145EnzRrc64sGTyGEbptt9W","type":"message","role":"assistant","content":[{"type":"text","text":"The user's request is \"Dashboard anpassen\" (adjust/customize dashboard) but it's quite vague - there's no specific change requested. The existing dashboard is a well-built tool management system (Werkzeugverwaltung) with:\n\n- Active checkouts view with overdue/due-today tracking\n- Checkout and return forms\n- Sidebar with tool overview, maintenance, storage locations, activity\n- Mobile-responsive layout\n\nSince the request is vague (\"Dashboard anpassen\"), I need to ask what specific changes are wanted. However, the task instructions say to interpret what users need and act. Let me look at what could be improved based on the current state - a useful enhancement would be adding a **Refresh** button and showing the **last updated** timestamp, as these are common practical needs for a dashboard that shows live data.\n\nLet me make a practical, user-friendly improvement: add a visible refresh button with a \"last updated\" timestamp to the header, so users can see when data was last fetched and manually refresh."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8210,"cache_creation_input_tokens":18852,"cache_read_input_tokens":18331,"cache_creation":{"ephemeral_5m_input_tokens":18852,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrphPG6DKcoPLzU2wWte","type":"assistant","uuid":"9ce773b2-9e00-46f1-b2d8-4af891ff9e33","timestamp":"2026-02-06T12:34:28.821Z"}
{"parentUuid":"9ce773b2-9e00-46f1-b2d8-4af891ff9e33","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_0145EnzRrc64sGTyGEbptt9W","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_013PS3Hpn6yu5L9x73HoHBy3","name":"TodoWrite","input":{"todos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"in_progress","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"pending","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8210,"cache_creation_input_tokens":18852,"cache_read_input_tokens":18331,"cache_creation":{"ephemeral_5m_input_tokens":18852,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrphPG6DKcoPLzU2wWte","type":"assistant","uuid":"30b12f0e-3a45-4428-b73b-201b40e2fc80","timestamp":"2026-02-06T12:34:30.620Z"}
{"parentUuid":"30b12f0e-3a45-4428-b73b-201b40e2fc80","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_013PS3Hpn6yu5L9x73HoHBy3","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"uuid":"3440098d-7fad-4362-bfef-49f3e07fff5f","timestamp":"2026-02-06T12:34:30.657Z","toolUseResult":{"oldTodos":[],"newTodos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"in_progress","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"pending","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}]}}
{"parentUuid":"3440098d-7fad-4362-bfef-49f3e07fff5f","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_0166mRhPB4TcNyRzeP7jF77x","type":"message","role":"assistant","content":[{"type":"text","text":"I'll add a refresh button with a \"last updated\" timestamp to both the desktop and mobile headers, giving users clear visibility into data freshness and the ability to manually refresh."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":8626,"cache_read_input_tokens":37183,"cache_creation":{"ephemeral_5m_input_tokens":8626,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpiDG77fidyAQm2qLJ3","type":"assistant","uuid":"3fa2210d-9d1a-4f07-b061-1cdc57715763","timestamp":"2026-02-06T12:34:33.570Z"}
{"parentUuid":"3fa2210d-9d1a-4f07-b061-1cdc57715763","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_0166mRhPB4TcNyRzeP7jF77x","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014RTtXQnphy2LmwbfUjttKV","name":"Edit","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx","old_string":"  // UI states\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);","new_string":"  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":8626,"cache_read_input_tokens":37183,"cache_creation":{"ephemeral_5m_input_tokens":8626,"ephemeral_1h_input_tokens":0},"output_tokens":380,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpiDG77fidyAQm2qLJ3","type":"assistant","uuid":"ca273333-e1ce-4d78-b21f-0d27d15571f2","timestamp":"2026-02-06T12:34:37.057Z"}
{"parentUuid":"ca273333-e1ce-4d78-b21f-0d27d15571f2","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014RTtXQnphy2LmwbfUjttKV","type":"tool_result","content":"The file /home/user/app/src/pages/Dashboard.tsx has been updated successfully."}]},"uuid":"ad702230-1ce5-44a0-960b-f622426dec98","timestamp":"2026-02-06T12:34:37.095Z","toolUseResult":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","oldString":"  // UI states\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);","newString":"  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);","originalFile":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","structuredPatch":[{"oldStart":372,"oldLines":10,"newStart":372,"newLines":12,"lines":[" ","   // UI states","   const [loading, setLoading] = useState(true);","+  const [refreshing, setRefreshing] = useState(false);","   const [error, setError] = useState<Error | null>(null);","   const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);","   const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);","   const [submitting, setSubmitting] = useState(false);","+  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);"," ","   // Fetch all data","   const fetchData = async () => {"]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"ad702230-1ce5-44a0-960b-f622426dec98","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01XkL4X3UBgGYH1BM53cWvKW","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018yruW8UKwP3dQCbPF9ZwHR","name":"Edit","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx","old_string":"      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n    } catch (err) {","new_string":"      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n      setLastUpdated(new Date());\n    } catch (err) {"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":412,"cache_read_input_tokens":45809,"cache_creation":{"ephemeral_5m_input_tokens":412,"ephemeral_1h_input_tokens":0},"output_tokens":24,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpigoZEZUQS8h2WvBUD","type":"assistant","uuid":"b1e99857-34b7-46af-9676-acd3178e5997","timestamp":"2026-02-06T12:34:41.123Z"}
{"parentUuid":"b1e99857-34b7-46af-9676-acd3178e5997","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018yruW8UKwP3dQCbPF9ZwHR","type":"tool_result","content":"The file /home/user/app/src/pages/Dashboard.tsx has been updated successfully."}]},"uuid":"86727f1f-8cff-4d69-84d1-b83c87892dec","timestamp":"2026-02-06T12:34:41.144Z","toolUseResult":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","oldString":"      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n    } catch (err) {","newString":"      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n      setLastUpdated(new Date());\n    } catch (err) {","originalFile":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","structuredPatch":[{"oldStart":396,"oldLines":6,"newStart":396,"newLines":7,"lines":["       setRueckgaben(r);","       setMitarbeiter(m);","       setLagerorte(l);","+      setLastUpdated(new Date());","     } catch (err) {","       setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));","     } finally {"]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"86727f1f-8cff-4d69-84d1-b83c87892dec","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01Ch2F5yvpTgjpEvwMTKk8ay","type":"message","role":"assistant","content":[{"type":"text","text":"Now add a refresh handler function:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":260,"cache_read_input_tokens":46221,"cache_creation":{"ephemeral_5m_input_tokens":260,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpiz4PMxpmqNm3Xj4eQ","type":"assistant","uuid":"d9d62b7a-5f26-4df2-ba6a-41f8500d3d62","timestamp":"2026-02-06T12:34:43.626Z"}
{"parentUuid":"d9d62b7a-5f26-4df2-ba6a-41f8500d3d62","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01Ch2F5yvpTgjpEvwMTKk8ay","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01KnDN3wRrQME1ogY241itPz","name":"Edit","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx","old_string":"  useEffect(() => {\n    fetchData();\n  }, []);","new_string":"  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Refresh data without full loading state\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await fetchData();\n    setRefreshing(false);\n  };"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":260,"cache_read_input_tokens":46221,"cache_creation":{"ephemeral_5m_input_tokens":260,"ephemeral_1h_input_tokens":0},"output_tokens":190,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpiz4PMxpmqNm3Xj4eQ","type":"assistant","uuid":"9e8f8fd2-f81e-4fe4-8ebd-209d473f973b","timestamp":"2026-02-06T12:34:45.150Z"}
{"parentUuid":"9e8f8fd2-f81e-4fe4-8ebd-209d473f973b","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01KnDN3wRrQME1ogY241itPz","type":"tool_result","content":"The file /home/user/app/src/pages/Dashboard.tsx has been updated successfully."}]},"uuid":"4cf09ad3-0429-4c6a-a405-7e6cbc0722b3","timestamp":"2026-02-06T12:34:45.172Z","toolUseResult":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","oldString":"  useEffect(() => {\n    fetchData();\n  }, []);","newString":"  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Refresh data without full loading state\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await fetchData();\n    setRefreshing(false);\n  };","originalFile":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n      setLastUpdated(new Date());\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","structuredPatch":[{"oldStart":408,"oldLines":6,"newStart":408,"newLines":13,"lines":["     fetchData();","   }, []);"," ","+  // Refresh data without full loading state","+  const handleRefresh = async () => {","+    setRefreshing(true);","+    await fetchData();","+    setRefreshing(false);","+  };","+","   // Create lookup maps","   const werkzeugeMap = useMemo(() => {","     const map = new Map<string, Werkzeuge>();"]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"4cf09ad3-0429-4c6a-a405-7e6cbc0722b3","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01DdiRzBP6zyX8wSkjL35pz5","type":"message","role":"assistant","content":[{"type":"text","text":"Now update the desktop header to include the refresh button and last-updated timestamp:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":222,"cache_read_input_tokens":46481,"cache_creation":{"ephemeral_5m_input_tokens":222,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpjHJiiaAPF3m56B78e","type":"assistant","uuid":"60052ca7-15f2-4414-8c36-d86d4cbefac9","timestamp":"2026-02-06T12:34:47.331Z"}
{"parentUuid":"60052ca7-15f2-4414-8c36-d86d4cbefac9","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01DdiRzBP6zyX8wSkjL35pz5","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01L3mTewpgwp9wrjuShn8D2b","name":"Edit","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx","old_string":"      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>","new_string":"      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n          {lastUpdated && (\n            <span className=\"text-xs text-muted-foreground\">\n              Aktualisiert: {format(lastUpdated, 'HH:mm', { locale: de })} Uhr\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            className=\"gap-2\"\n          >\n            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n            Aktualisieren\n          </Button>\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":222,"cache_read_input_tokens":46481,"cache_creation":{"ephemeral_5m_input_tokens":222,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpjHJiiaAPF3m56B78e","type":"assistant","uuid":"5e33c565-a27c-4514-8bf9-d6167cc736b0","timestamp":"2026-02-06T12:34:52.304Z"}
{"parentUuid":"5e33c565-a27c-4514-8bf9-d6167cc736b0","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01L3mTewpgwp9wrjuShn8D2b","type":"tool_result","content":"The file /home/user/app/src/pages/Dashboard.tsx has been updated successfully."}]},"uuid":"eb8d712f-f278-4d8b-a9c2-652d205d0a3b","timestamp":"2026-02-06T12:34:52.330Z","toolUseResult":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","oldString":"      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>","newString":"      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n          {lastUpdated && (\n            <span className=\"text-xs text-muted-foreground\">\n              Aktualisiert: {format(lastUpdated, 'HH:mm', { locale: de })} Uhr\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            className=\"gap-2\"\n          >\n            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n            Aktualisieren\n          </Button>\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>","originalFile":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n      setLastUpdated(new Date());\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Refresh data without full loading state\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await fetchData();\n    setRefreshing(false);\n  };\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n        <div className=\"flex items-center gap-4\">\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","structuredPatch":[{"oldStart":673,"oldLines":8,"newStart":673,"newLines":25,"lines":["     <div className=\"min-h-screen bg-background\">","       {/* Header - Desktop */}","       <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">","-        <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>","         <div className=\"flex items-center gap-4\">","+          <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>","+          {lastUpdated && (","+            <span className=\"text-xs text-muted-foreground\">","+              Aktualisiert: {format(lastUpdated, 'HH:mm', { locale: de })} Uhr","+            </span>","+          )}","+        </div>","+        <div className=\"flex items-center gap-3\">","+          <Button","+            variant=\"outline\"","+            size=\"sm\"","+            onClick={handleRefresh}","+            disabled={refreshing}","+            className=\"gap-2\"","+          >","+            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />","+            Aktualisieren","+          </Button>","           <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>","             <DialogTrigger asChild>","               <Button className=\"gap-2\">"]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"eb8d712f-f278-4d8b-a9c2-652d205d0a3b","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01QvtSpKLLJRrFGTwdvisEVE","type":"message","role":"assistant","content":[{"type":"text","text":"Now update the mobile header to also show the refresh option:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":697,"cache_read_input_tokens":46703,"cache_creation":{"ephemeral_5m_input_tokens":697,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpjp598KiDFK1jvH85F","type":"assistant","uuid":"fc4a067e-a8b3-42b5-ae72-4eede3e674ed","timestamp":"2026-02-06T12:34:54.712Z"}
{"parentUuid":"fc4a067e-a8b3-42b5-ae72-4eede3e674ed","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01QvtSpKLLJRrFGTwdvisEVE","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011goT5cL7anYqTsj6oBQXiJ","name":"Edit","input":{"file_path":"/home/user/app/src/pages/Dashboard.tsx","old_string":"      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>","new_string":"      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            className=\"h-8 w-8\"\n          >\n            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n          </Button>\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            {werkzeuge.length} Werkzeuge\n          </Badge>\n        </div>\n      </header>"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":697,"cache_read_input_tokens":46703,"cache_creation":{"ephemeral_5m_input_tokens":697,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpjp598KiDFK1jvH85F","type":"assistant","uuid":"a9ceea9f-c4e2-4e52-9736-156050f6d98b","timestamp":"2026-02-06T12:34:57.942Z"}
{"parentUuid":"a9ceea9f-c4e2-4e52-9736-156050f6d98b","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011goT5cL7anYqTsj6oBQXiJ","type":"tool_result","content":"The file /home/user/app/src/pages/Dashboard.tsx has been updated successfully."}]},"uuid":"b3c6e4b7-ff9e-4bae-b6de-3aedeb8d8573","timestamp":"2026-02-06T12:34:57.973Z","toolUseResult":{"filePath":"/home/user/app/src/pages/Dashboard.tsx","oldString":"      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>","newString":"      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            className=\"h-8 w-8\"\n          >\n            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n          </Button>\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            {werkzeuge.length} Werkzeuge\n          </Badge>\n        </div>\n      </header>","originalFile":"import { useState, useEffect, useMemo } from 'react';\nimport type { Werkzeuge, Werkzeugausgabe, Werkzeugrueckgabe, Mitarbeiter, Lagerorte } from '@/types/app';\nimport { APP_IDS } from '@/types/app';\nimport { LivingAppsService, extractRecordId, createRecordUrl } from '@/services/livingAppsService';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from '@/components/ui/dialog';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from '@/components/ui/sheet';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/components/ui/table';\nimport { format, parseISO, formatDistance, differenceInDays, isAfter, isBefore, isToday } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport {\n  Wrench,\n  AlertCircle,\n  Clock,\n  MapPin,\n  Users,\n  Settings,\n  Plus,\n  ArrowRight,\n  CalendarDays,\n  Package,\n  RefreshCw,\n} from 'lucide-react';\n\n// Types for enriched data\ninterface EnrichedCheckout extends Werkzeugausgabe {\n  werkzeugData?: Werkzeuge;\n  mitarbeiterData?: Mitarbeiter;\n  isOverdue: boolean;\n  isDueToday: boolean;\n  daysOverdue: number;\n}\n\ninterface RecentActivity {\n  type: 'checkout' | 'return';\n  werkzeugName: string;\n  mitarbeiterName: string;\n  date: string;\n  timestamp: Date;\n}\n\n// Loading skeleton component\nfunction LoadingState() {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6\">\n      <div className=\"max-w-7xl mx-auto space-y-6\">\n        {/* Header skeleton */}\n        <div className=\"flex justify-between items-center\">\n          <Skeleton className=\"h-8 w-48\" />\n          <Skeleton className=\"h-10 w-40\" />\n        </div>\n\n        {/* Hero skeleton */}\n        <Skeleton className=\"h-32 w-full rounded-2xl\" />\n\n        {/* Content skeleton */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 space-y-4\">\n            <Skeleton className=\"h-64 w-full rounded-xl\" />\n          </div>\n          <div className=\"space-y-4\">\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n            <Skeleton className=\"h-32 w-full rounded-xl\" />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Error state component\nfunction ErrorState({ error, onRetry }: { error: Error; onRetry: () => void }) {\n  return (\n    <div className=\"min-h-screen bg-background p-4 md:p-6 flex items-center justify-center\">\n      <Alert variant=\"destructive\" className=\"max-w-md\">\n        <AlertCircle className=\"h-4 w-4\" />\n        <AlertTitle>Fehler beim Laden</AlertTitle>\n        <AlertDescription className=\"mt-2\">\n          <p className=\"mb-4\">{error.message}</p>\n          <Button variant=\"outline\" onClick={onRetry} className=\"w-full\">\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\n            Erneut versuchen\n          </Button>\n        </AlertDescription>\n      </Alert>\n    </div>\n  );\n}\n\n// Empty state component\nfunction EmptyState({ onAddFirst }: { onAddFirst: () => void }) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n      <Package className=\"h-12 w-12 text-muted-foreground mb-4\" />\n      <h3 className=\"text-lg font-semibold mb-2\">Keine Ausleihen vorhanden</h3>\n      <p className=\"text-muted-foreground mb-4 max-w-sm\">\n        Beginnen Sie damit, Werkzeuge an Mitarbeiter auszugeben.\n      </p>\n      <Button onClick={onAddFirst}>\n        <Plus className=\"h-4 w-4 mr-2\" />\n        Werkzeug ausgeben\n      </Button>\n    </div>\n  );\n}\n\n// Checkout form component\nfunction CheckoutForm({\n  werkzeuge,\n  mitarbeiter,\n  activeCheckoutToolIds,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  werkzeuge: Werkzeuge[];\n  mitarbeiter: Mitarbeiter[];\n  activeCheckoutToolIds: Set<string>;\n  onSubmit: (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [selectedWerkzeug, setSelectedWerkzeug] = useState('');\n  const [selectedMitarbeiter, setSelectedMitarbeiter] = useState('');\n  const [rueckgabedatum, setRueckgabedatum] = useState('');\n  const [verwendungszweck, setVerwendungszweck] = useState('');\n\n  // Filter to only show available tools (not currently checked out)\n  const availableWerkzeuge = werkzeuge.filter(\n    (w) => !activeCheckoutToolIds.has(w.record_id)\n  );\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum) return;\n\n    onSubmit({\n      werkzeug: selectedWerkzeug,\n      mitarbeiter: selectedMitarbeiter,\n      geplantes_rueckgabedatum: rueckgabedatum,\n      verwendungszweck: verwendungszweck || undefined,\n    });\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"werkzeug\">Werkzeug *</Label>\n        <Select value={selectedWerkzeug} onValueChange={setSelectedWerkzeug}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Werkzeug auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {availableWerkzeuge.length === 0 ? (\n              <div className=\"p-2 text-sm text-muted-foreground\">\n                Keine Werkzeuge verfÃ¼gbar\n              </div>\n            ) : (\n              availableWerkzeuge.map((w) => (\n                <SelectItem key={w.record_id} value={w.record_id}>\n                  {w.fields.werkzeugname || 'Unbenannt'}{' '}\n                  {w.fields.hersteller && `(${w.fields.hersteller})`}\n                </SelectItem>\n              ))\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"mitarbeiter\">Mitarbeiter *</Label>\n        <Select value={selectedMitarbeiter} onValueChange={setSelectedMitarbeiter}>\n          <SelectTrigger>\n            <SelectValue placeholder=\"Mitarbeiter auswÃ¤hlen...\" />\n          </SelectTrigger>\n          <SelectContent>\n            {mitarbeiter.map((m) => (\n              <SelectItem key={m.record_id} value={m.record_id}>\n                {m.fields.vorname} {m.fields.nachname}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"rueckgabedatum\">Geplantes RÃ¼ckgabedatum *</Label>\n        <Input\n          type=\"date\"\n          id=\"rueckgabedatum\"\n          value={rueckgabedatum}\n          onChange={(e) => setRueckgabedatum(e.target.value)}\n          min={format(new Date(), 'yyyy-MM-dd')}\n          required\n        />\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"verwendungszweck\">Verwendungszweck</Label>\n        <Textarea\n          id=\"verwendungszweck\"\n          value={verwendungszweck}\n          onChange={(e) => setVerwendungszweck(e.target.value)}\n          placeholder=\"Optional: WofÃ¼r wird das Werkzeug benÃ¶tigt?\"\n          rows={3}\n        />\n      </div>\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button\n          type=\"submit\"\n          className=\"flex-1\"\n          disabled={!selectedWerkzeug || !selectedMitarbeiter || !rueckgabedatum || submitting}\n        >\n          {submitting ? 'Wird gespeichert...' : 'Ausgeben'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Return form component\nfunction ReturnForm({\n  checkout,\n  onSubmit,\n  onCancel,\n  submitting,\n}: {\n  checkout: EnrichedCheckout;\n  onSubmit: (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => void;\n  onCancel: () => void;\n  submitting: boolean;\n}) {\n  const [zustand, setZustand] = useState('wie_ausgegeben');\n  const [beschaedigungen, setBeschaedigungen] = useState('');\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSubmit({\n      werkzeugausgabe: checkout.record_id,\n      zustand_bei_rueckgabe: zustand,\n      beschaedigungen: beschaedigungen || undefined,\n    });\n  };\n\n  const zustandOptions = [\n    { key: 'wie_ausgegeben', label: 'Wie ausgegeben' },\n    { key: 'leichte_gebrauchsspuren', label: 'Leichte Gebrauchsspuren' },\n    { key: 'starke_gebrauchsspuren', label: 'Starke Gebrauchsspuren' },\n    { key: 'beschaedigt', label: 'BeschÃ¤digt' },\n    { key: 'defekt', label: 'Defekt' },\n  ];\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"p-4 bg-muted rounded-lg mb-4\">\n        <p className=\"font-medium\">\n          {checkout.werkzeugData?.fields.werkzeugname || 'Unbekanntes Werkzeug'}\n        </p>\n        <p className=\"text-sm text-muted-foreground\">\n          Ausgeliehen an: {checkout.mitarbeiterData?.fields.vorname}{' '}\n          {checkout.mitarbeiterData?.fields.nachname}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"zustand\">Zustand bei RÃ¼ckgabe *</Label>\n        <Select value={zustand} onValueChange={setZustand}>\n          <SelectTrigger>\n            <SelectValue />\n          </SelectTrigger>\n          <SelectContent>\n            {zustandOptions.map((opt) => (\n              <SelectItem key={opt.key} value={opt.key}>\n                {opt.label}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {(zustand === 'beschaedigt' || zustand === 'defekt') && (\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"beschaedigungen\">BeschÃ¤digungen beschreiben</Label>\n          <Textarea\n            id=\"beschaedigungen\"\n            value={beschaedigungen}\n            onChange={(e) => setBeschaedigungen(e.target.value)}\n            placeholder=\"Beschreiben Sie die SchÃ¤den...\"\n            rows={3}\n          />\n        </div>\n      )}\n\n      <div className=\"flex gap-3 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={onCancel}\n          className=\"flex-1\"\n          disabled={submitting}\n        >\n          Abbrechen\n        </Button>\n        <Button type=\"submit\" className=\"flex-1\" disabled={submitting}>\n          {submitting ? 'Wird gespeichert...' : 'RÃ¼ckgabe bestÃ¤tigen'}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n// Main Dashboard component\nexport default function Dashboard() {\n  // Data states\n  const [werkzeuge, setWerkzeuge] = useState<Werkzeuge[]>([]);\n  const [ausgaben, setAusgaben] = useState<Werkzeugausgabe[]>([]);\n  const [rueckgaben, setRueckgaben] = useState<Werkzeugrueckgabe[]>([]);\n  const [mitarbeiter, setMitarbeiter] = useState<Mitarbeiter[]>([]);\n  const [lagerorte, setLagerorte] = useState<Lagerorte[]>([]);\n\n  // UI states\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [checkoutDialogOpen, setCheckoutDialogOpen] = useState(false);\n  const [selectedCheckout, setSelectedCheckout] = useState<EnrichedCheckout | null>(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\n\n  // Fetch all data\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      const [w, a, r, m, l] = await Promise.all([\n        LivingAppsService.getWerkzeuge(),\n        LivingAppsService.getWerkzeugausgabe(),\n        LivingAppsService.getWerkzeugrueckgabe(),\n        LivingAppsService.getMitarbeiter(),\n        LivingAppsService.getLagerorte(),\n      ]);\n      setWerkzeuge(w);\n      setAusgaben(a);\n      setRueckgaben(r);\n      setMitarbeiter(m);\n      setLagerorte(l);\n      setLastUpdated(new Date());\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unbekannter Fehler'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  // Refresh data without full loading state\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await fetchData();\n    setRefreshing(false);\n  };\n\n  // Create lookup maps\n  const werkzeugeMap = useMemo(() => {\n    const map = new Map<string, Werkzeuge>();\n    werkzeuge.forEach((w) => map.set(w.record_id, w));\n    return map;\n  }, [werkzeuge]);\n\n  const mitarbeiterMap = useMemo(() => {\n    const map = new Map<string, Mitarbeiter>();\n    mitarbeiter.forEach((m) => map.set(m.record_id, m));\n    return map;\n  }, [mitarbeiter]);\n\n  // Get IDs of returned checkouts\n  const returnedCheckoutIds = useMemo(() => {\n    const ids = new Set<string>();\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      if (checkoutId) ids.add(checkoutId);\n    });\n    return ids;\n  }, [rueckgaben]);\n\n  // Get active checkouts (not returned)\n  const activeCheckouts = useMemo<EnrichedCheckout[]>(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    return ausgaben\n      .filter((a) => !returnedCheckoutIds.has(a.record_id))\n      .map((a) => {\n        const werkzeugId = extractRecordId(a.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n\n        const plannedReturn = a.fields.geplantes_rueckgabedatum\n          ? parseISO(a.fields.geplantes_rueckgabedatum)\n          : null;\n\n        const isOverdue = plannedReturn ? isBefore(plannedReturn, today) : false;\n        const isDueToday = plannedReturn ? isToday(plannedReturn) : false;\n        const daysOverdue = plannedReturn && isOverdue ? differenceInDays(today, plannedReturn) : 0;\n\n        return {\n          ...a,\n          werkzeugData: werkzeugId ? werkzeugeMap.get(werkzeugId) : undefined,\n          mitarbeiterData: mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : undefined,\n          isOverdue,\n          isDueToday,\n          daysOverdue,\n        };\n      })\n      .sort((a, b) => {\n        // Sort: overdue first, then due today, then by planned return date\n        if (a.isOverdue && !b.isOverdue) return -1;\n        if (!a.isOverdue && b.isOverdue) return 1;\n        if (a.isDueToday && !b.isDueToday) return -1;\n        if (!a.isDueToday && b.isDueToday) return 1;\n\n        const dateA = a.fields.geplantes_rueckgabedatum || '';\n        const dateB = b.fields.geplantes_rueckgabedatum || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [ausgaben, returnedCheckoutIds, werkzeugeMap, mitarbeiterMap]);\n\n  // IDs of currently checked-out tools\n  const activeCheckoutToolIds = useMemo(() => {\n    const ids = new Set<string>();\n    activeCheckouts.forEach((c) => {\n      const toolId = extractRecordId(c.fields.werkzeug);\n      if (toolId) ids.add(toolId);\n    });\n    return ids;\n  }, [activeCheckouts]);\n\n  // Overdue and due-today counts\n  const overdueCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isOverdue),\n    [activeCheckouts]\n  );\n  const dueTodayCheckouts = useMemo(\n    () => activeCheckouts.filter((c) => c.isDueToday),\n    [activeCheckouts]\n  );\n\n  // Tools needing maintenance\n  const toolsNeedingMaintenance = useMemo(() => {\n    const today = new Date();\n    const twoWeeksFromNow = new Date(today);\n    twoWeeksFromNow.setDate(twoWeeksFromNow.getDate() + 14);\n\n    return werkzeuge\n      .filter((w) => {\n        if (!w.fields.naechste_wartung) return false;\n        const maintenanceDate = parseISO(w.fields.naechste_wartung);\n        return isBefore(maintenanceDate, twoWeeksFromNow);\n      })\n      .sort((a, b) => {\n        const dateA = a.fields.naechste_wartung || '';\n        const dateB = b.fields.naechste_wartung || '';\n        return dateA.localeCompare(dateB);\n      });\n  }, [werkzeuge]);\n\n  // Tool conditions breakdown\n  const conditionBreakdown = useMemo(() => {\n    const counts: Record<string, number> = {\n      neu: 0,\n      sehr_gut: 0,\n      gut: 0,\n      befriedigend: 0,\n      ausreichend: 0,\n      defekt: 0,\n    };\n    werkzeuge.forEach((w) => {\n      const condition = w.fields.zustand || 'gut';\n      if (condition in counts) {\n        counts[condition]++;\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Recent activity\n  const recentActivity = useMemo<RecentActivity[]>(() => {\n    const activities: RecentActivity[] = [];\n\n    // Add checkouts\n    ausgaben.forEach((a) => {\n      const werkzeugId = extractRecordId(a.fields.werkzeug);\n      const mitarbeiterId = extractRecordId(a.fields.mitarbeiter);\n      const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n      const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n      activities.push({\n        type: 'checkout',\n        werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n        mitarbeiterName: mitarbeiterData\n          ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n          : 'Unbekannt',\n        date: a.createdat,\n        timestamp: parseISO(a.createdat),\n      });\n    });\n\n    // Add returns\n    rueckgaben.forEach((r) => {\n      const checkoutId = extractRecordId(r.fields.werkzeugausgabe);\n      const checkout = checkoutId ? ausgaben.find((a) => a.record_id === checkoutId) : null;\n\n      if (checkout) {\n        const werkzeugId = extractRecordId(checkout.fields.werkzeug);\n        const mitarbeiterId = extractRecordId(checkout.fields.mitarbeiter);\n        const werkzeugData = werkzeugId ? werkzeugeMap.get(werkzeugId) : null;\n        const mitarbeiterData = mitarbeiterId ? mitarbeiterMap.get(mitarbeiterId) : null;\n\n        activities.push({\n          type: 'return',\n          werkzeugName: werkzeugData?.fields.werkzeugname || 'Unbekannt',\n          mitarbeiterName: mitarbeiterData\n            ? `${mitarbeiterData.fields.vorname?.charAt(0)}. ${mitarbeiterData.fields.nachname}`\n            : 'Unbekannt',\n          date: r.createdat,\n          timestamp: parseISO(r.createdat),\n        });\n      }\n    });\n\n    return activities.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime()).slice(0, 5);\n  }, [ausgaben, rueckgaben, werkzeugeMap, mitarbeiterMap]);\n\n  // Tools per location\n  const toolsPerLocation = useMemo(() => {\n    const counts = new Map<string, number>();\n    werkzeuge.forEach((w) => {\n      const locationId = extractRecordId(w.fields.aktueller_lagerort);\n      if (locationId) {\n        counts.set(locationId, (counts.get(locationId) || 0) + 1);\n      }\n    });\n    return counts;\n  }, [werkzeuge]);\n\n  // Handle checkout submission\n  const handleCheckoutSubmit = async (data: {\n    werkzeug: string;\n    mitarbeiter: string;\n    geplantes_rueckgabedatum: string;\n    verwendungszweck?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const ausgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugausgabeEntry({\n        werkzeug: createRecordUrl(APP_IDS.WERKZEUGE, data.werkzeug),\n        mitarbeiter: createRecordUrl(APP_IDS.MITARBEITER, data.mitarbeiter),\n        ausgabedatum,\n        geplantes_rueckgabedatum: data.geplantes_rueckgabedatum,\n        verwendungszweck: data.verwendungszweck,\n      });\n\n      setCheckoutDialogOpen(false);\n      await fetchData();\n    } catch (err) {\n      console.error('Checkout failed:', err);\n      alert('Fehler beim Erstellen der Ausgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Handle return submission\n  const handleReturnSubmit = async (data: {\n    werkzeugausgabe: string;\n    zustand_bei_rueckgabe: string;\n    beschaedigungen?: string;\n  }) => {\n    try {\n      setSubmitting(true);\n      const now = new Date();\n      const rueckgabedatum = format(now, \"yyyy-MM-dd'T'HH:mm\");\n\n      await LivingAppsService.createWerkzeugrueckgabeEntry({\n        werkzeugausgabe: createRecordUrl(APP_IDS.WERKZEUGAUSGABE, data.werkzeugausgabe),\n        rueckgabedatum,\n        zustand_bei_rueckgabe: data.zustand_bei_rueckgabe as Werkzeugrueckgabe['fields']['zustand_bei_rueckgabe'],\n        beschaedigungen: data.beschaedigungen,\n      });\n\n      setSelectedCheckout(null);\n      await fetchData();\n    } catch (err) {\n      console.error('Return failed:', err);\n      alert('Fehler beim Erstellen der RÃ¼ckgabe. Bitte versuchen Sie es erneut.');\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  // Get initials for employee badge\n  const getInitials = (mitarbeiterData?: Mitarbeiter) => {\n    if (!mitarbeiterData) return '??';\n    const first = mitarbeiterData.fields.vorname?.charAt(0) || '';\n    const last = mitarbeiterData.fields.nachname?.charAt(0) || '';\n    return `${first}${last}`.toUpperCase();\n  };\n\n  // Loading state\n  if (loading) return <LoadingState />;\n\n  // Error state\n  if (error) return <ErrorState error={error} onRetry={fetchData} />;\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header - Desktop */}\n      <header className=\"hidden md:flex items-center justify-between px-6 py-4 bg-card border-b border-border\">\n        <div className=\"flex items-center gap-4\">\n          <h1 className=\"text-2xl font-semibold\">Werkzeugverwaltung</h1>\n          {lastUpdated && (\n            <span className=\"text-xs text-muted-foreground\">\n              Aktualisiert: {format(lastUpdated, 'HH:mm', { locale: de })} Uhr\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={handleRefresh}\n            disabled={refreshing}\n            className=\"gap-2\"\n          >\n            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />\n            Aktualisieren\n          </Button>\n          <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"gap-2\">\n                <Plus className=\"h-4 w-4\" />\n                Werkzeug ausgeben\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-md\">\n              <DialogHeader>\n                <DialogTitle>Werkzeug ausgeben</DialogTitle>\n              </DialogHeader>\n              <CheckoutForm\n                werkzeuge={werkzeuge}\n                mitarbeiter={mitarbeiter}\n                activeCheckoutToolIds={activeCheckoutToolIds}\n                onSubmit={handleCheckoutSubmit}\n                onCancel={() => setCheckoutDialogOpen(false)}\n                submitting={submitting}\n              />\n            </DialogContent>\n          </Dialog>\n        </div>\n      </header>\n\n      {/* Header - Mobile */}\n      <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">\n        <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          {werkzeuge.length} Werkzeuge\n        </Badge>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"p-4 md:p-6 pb-24 md:pb-6\">\n        <div className=\"max-w-7xl mx-auto\">\n          {/* Desktop Layout: 65/35 split */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-[1fr_380px] gap-6\">\n            {/* Left Column - Main Content */}\n            <div className=\"space-y-6\">\n              {/* Hero Card */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardContent className=\"p-6 md:p-8\">\n                  <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n                    <div className=\"flex flex-col items-center md:items-start\">\n                      <span\n                        className=\"text-7xl font-bold tabular-nums\"\n                        style={{ color: 'hsl(38 92% 50%)' }}\n                      >\n                        {activeCheckouts.length}\n                      </span>\n                      <span className=\"text-muted-foreground text-sm mt-1\">\n                        Werkzeuge ausgeliehen\n                      </span>\n                    </div>\n                    <div className=\"flex flex-wrap justify-center md:justify-end gap-3\">\n                      {overdueCheckouts.length > 0 && (\n                        <Badge variant=\"destructive\" className=\"gap-1.5 py-1.5 px-3\">\n                          <AlertCircle className=\"h-3.5 w-3.5\" />\n                          {overdueCheckouts.length} Ã¼berfÃ¤llig\n                        </Badge>\n                      )}\n                      {dueTodayCheckouts.length > 0 && (\n                        <Badge\n                          className=\"gap-1.5 py-1.5 px-3\"\n                          style={{\n                            backgroundColor: 'hsl(38 92% 95%)',\n                            color: 'hsl(38 92% 35%)',\n                          }}\n                        >\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          {dueTodayCheckouts.length} heute fÃ¤llig\n                        </Badge>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overdue Section */}\n              {overdueCheckouts.length > 0 && (\n                <Card className=\"border-destructive/50 bg-destructive/5\">\n                  <CardHeader className=\"pb-3\">\n                    <CardTitle className=\"flex items-center gap-2 text-destructive text-base\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      ÃœberfÃ¤llige RÃ¼ckgaben\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"pt-0\">\n                    <div className=\"space-y-2\">\n                      {overdueCheckouts.slice(0, 3).map((checkout) => (\n                        <div\n                          key={checkout.record_id}\n                          className=\"flex items-center justify-between p-3 bg-card rounded-lg cursor-pointer hover:shadow-sm transition-shadow\"\n                          onClick={() => setSelectedCheckout(checkout)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div\n                              className=\"w-9 h-9 rounded-full flex items-center justify-center text-xs font-medium\"\n                              style={{\n                                backgroundColor: 'hsl(38 92% 95%)',\n                                color: 'hsl(38 92% 35%)',\n                              }}\n                            >\n                              {getInitials(checkout.mitarbeiterData)}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">\n                                {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                {checkout.mitarbeiterData?.fields.nachname}\n                              </p>\n                            </div>\n                          </div>\n                          <Badge variant=\"destructive\" className=\"text-xs\">\n                            {checkout.daysOverdue} {checkout.daysOverdue === 1 ? 'Tag' : 'Tage'}\n                          </Badge>\n                        </div>\n                      ))}\n                      {overdueCheckouts.length > 3 && (\n                        <p className=\"text-sm text-muted-foreground text-center pt-2\">\n                          +{overdueCheckouts.length - 3} weitere Ã¼berfÃ¤llige Ausleihen\n                        </p>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Active Checkouts List */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-base flex items-center gap-2\">\n                      <Wrench className=\"h-4 w-4\" />\n                      Ausgeliehen\n                      <Badge variant=\"secondary\" className=\"ml-1\">\n                        {activeCheckouts.length}\n                      </Badge>\n                    </CardTitle>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {activeCheckouts.length === 0 ? (\n                    <EmptyState onAddFirst={() => setCheckoutDialogOpen(true)} />\n                  ) : (\n                    <>\n                      {/* Mobile: Card list */}\n                      <div className=\"md:hidden space-y-3\">\n                        {activeCheckouts.map((checkout) => (\n                          <div\n                            key={checkout.record_id}\n                            className=\"p-4 rounded-xl border border-border bg-card cursor-pointer hover:shadow-sm transition-shadow\"\n                            onClick={() => setSelectedCheckout(checkout)}\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-3\">\n                                <div\n                                  className=\"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  {getInitials(checkout.mitarbeiterData)}\n                                </div>\n                                <div>\n                                  <p className=\"font-semibold\">\n                                    {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                  </p>\n                                  <p className=\"text-sm text-muted-foreground\">\n                                    {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                    {checkout.mitarbeiterData?.fields.nachname}\n                                  </p>\n                                </div>\n                              </div>\n                              {checkout.isOverdue ? (\n                                <Badge variant=\"destructive\" className=\"text-xs\">\n                                  ÃœberfÃ¤llig\n                                </Badge>\n                              ) : checkout.isDueToday ? (\n                                <Badge\n                                  className=\"text-xs\"\n                                  style={{\n                                    backgroundColor: 'hsl(38 92% 95%)',\n                                    color: 'hsl(38 92% 35%)',\n                                  }}\n                                >\n                                  Heute\n                                </Badge>\n                              ) : (\n                                <div\n                                  className=\"w-2.5 h-2.5 rounded-full\"\n                                  style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                />\n                              )}\n                            </div>\n                            <div className=\"flex items-center gap-4 text-xs text-muted-foreground\">\n                              <span className=\"flex items-center gap-1\">\n                                <CalendarDays className=\"h-3 w-3\" />\n                                {checkout.fields.ausgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.ausgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                              <ArrowRight className=\"h-3 w-3\" />\n                              <span>\n                                {checkout.fields.geplantes_rueckgabedatum\n                                  ? format(\n                                      parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                      'dd.MM.yyyy',\n                                      { locale: de }\n                                    )\n                                  : '-'}\n                              </span>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n\n                      {/* Desktop: Table */}\n                      <div className=\"hidden md:block\">\n                        <Table>\n                          <TableHeader>\n                            <TableRow>\n                              <TableHead>Werkzeug</TableHead>\n                              <TableHead>Mitarbeiter</TableHead>\n                              <TableHead>Ausgabedatum</TableHead>\n                              <TableHead>RÃ¼ckgabe bis</TableHead>\n                              <TableHead className=\"text-right\">Status</TableHead>\n                            </TableRow>\n                          </TableHeader>\n                          <TableBody>\n                            {activeCheckouts.map((checkout) => (\n                              <TableRow\n                                key={checkout.record_id}\n                                className=\"cursor-pointer hover:bg-muted/50\"\n                                onClick={() => setSelectedCheckout(checkout)}\n                              >\n                                <TableCell className=\"font-medium\">\n                                  {checkout.werkzeugData?.fields.werkzeugname || 'Unbekannt'}\n                                </TableCell>\n                                <TableCell>\n                                  <div className=\"flex items-center gap-2\">\n                                    <div\n                                      className=\"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium\"\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      {getInitials(checkout.mitarbeiterData)}\n                                    </div>\n                                    <span>\n                                      {checkout.mitarbeiterData?.fields.vorname}{' '}\n                                      {checkout.mitarbeiterData?.fields.nachname}\n                                    </span>\n                                  </div>\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.ausgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.ausgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell>\n                                  {checkout.fields.geplantes_rueckgabedatum\n                                    ? format(\n                                        parseISO(checkout.fields.geplantes_rueckgabedatum),\n                                        'dd.MM.yyyy',\n                                        { locale: de }\n                                      )\n                                    : '-'}\n                                </TableCell>\n                                <TableCell className=\"text-right\">\n                                  {checkout.isOverdue ? (\n                                    <Badge variant=\"destructive\">ÃœberfÃ¤llig</Badge>\n                                  ) : checkout.isDueToday ? (\n                                    <Badge\n                                      style={{\n                                        backgroundColor: 'hsl(38 92% 95%)',\n                                        color: 'hsl(38 92% 35%)',\n                                      }}\n                                    >\n                                      Heute fÃ¤llig\n                                    </Badge>\n                                  ) : (\n                                    <div className=\"flex items-center justify-end gap-2\">\n                                      <div\n                                        className=\"w-2 h-2 rounded-full\"\n                                        style={{ backgroundColor: 'hsl(142 71% 45%)' }}\n                                      />\n                                      <span className=\"text-sm text-muted-foreground\">OK</span>\n                                    </div>\n                                  )}\n                                </TableCell>\n                              </TableRow>\n                            ))}\n                          </TableBody>\n                        </Table>\n                      </div>\n                    </>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Right Column - Stats Sidebar (Desktop) */}\n            <div className=\"hidden lg:flex flex-col gap-4\">\n              {/* Tools Overview */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Package className=\"h-4 w-4\" />\n                    Werkzeuge Ãœbersicht\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{werkzeuge.length}</div>\n                  <div className=\"flex flex-wrap gap-2 text-xs\">\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Neu: {conditionBreakdown.neu + conditionBreakdown.sehr_gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Gut: {conditionBreakdown.gut}\n                    </span>\n                    <span className=\"px-2 py-1 rounded bg-muted\">\n                      Befr.: {conditionBreakdown.befriedigend + conditionBreakdown.ausreichend}\n                    </span>\n                    <span\n                      className=\"px-2 py-1 rounded\"\n                      style={{\n                        backgroundColor: 'hsl(0 84% 95%)',\n                        color: 'hsl(0 84% 40%)',\n                      }}\n                    >\n                      Defekt: {conditionBreakdown.defekt}\n                    </span>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Maintenance Due */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Settings className=\"h-4 w-4\" />\n                    Wartung fÃ¤llig\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{toolsNeedingMaintenance.length}</div>\n                  {toolsNeedingMaintenance.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {toolsNeedingMaintenance.slice(0, 3).map((tool) => (\n                        <div\n                          key={tool.record_id}\n                          className=\"flex items-center justify-between text-sm\"\n                        >\n                          <span className=\"truncate\">{tool.fields.werkzeugname}</span>\n                          <span className=\"text-muted-foreground text-xs\">\n                            {tool.fields.naechste_wartung\n                              ? format(parseISO(tool.fields.naechste_wartung), 'dd.MM.', {\n                                  locale: de,\n                                })\n                              : '-'}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">\n                      Keine Wartungen in den nÃ¤chsten 2 Wochen\n                    </p>\n                  )}\n                </CardContent>\n              </Card>\n\n              {/* Storage Locations */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    Lagerorte\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-3xl font-bold mb-3\">{lagerorte.length}</div>\n                  <div className=\"space-y-2\">\n                    {lagerorte.slice(0, 4).map((loc) => (\n                      <div\n                        key={loc.record_id}\n                        className=\"flex items-center justify-between text-sm\"\n                      >\n                        <span className=\"truncate\">{loc.fields.bezeichnung}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {toolsPerLocation.get(loc.record_id) || 0}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Recent Activity */}\n              <Card className=\"border-0 shadow-sm\">\n                <CardHeader className=\"pb-2\">\n                  <CardTitle className=\"text-base flex items-center gap-2\">\n                    <Clock className=\"h-4 w-4\" />\n                    AktivitÃ¤t\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {recentActivity.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {recentActivity.map((activity, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 text-sm\">\n                          <div\n                            className={`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${\n                              activity.type === 'checkout'\n                                ? 'bg-amber-500'\n                                : 'bg-green-500'\n                            }`}\n                          />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate\">\n                              <span className=\"font-medium\">{activity.werkzeugName}</span>\n                              <span className=\"text-muted-foreground\">\n                                {' â†’ '}\n                                {activity.mitarbeiterName}\n                              </span>\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {formatDistance(activity.timestamp, new Date(), {\n                                addSuffix: true,\n                                locale: de,\n                              })}\n                            </p>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm text-muted-foreground\">Keine AktivitÃ¤ten</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </div>\n\n          {/* Mobile: Quick Stats Row */}\n          <div className=\"md:hidden mt-6 overflow-x-auto pb-2 -mx-4 px-4\">\n            <div className=\"flex gap-3\" style={{ width: 'max-content' }}>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Package className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{werkzeuge.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Werkzeuge</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <MapPin className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{lagerorte.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Lagerorte</p>\n                </div>\n              </div>\n              <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                <Users className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-lg font-semibold\">{mitarbeiter.length}</p>\n                  <p className=\"text-xs text-muted-foreground\">Mitarbeiter</p>\n                </div>\n              </div>\n              {toolsNeedingMaintenance.length > 0 && (\n                <div className=\"px-4 py-3 rounded-xl bg-card border border-border flex items-center gap-3\">\n                  <Settings className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-lg font-semibold\">{toolsNeedingMaintenance.length}</p>\n                    <p className=\"text-xs text-muted-foreground\">Wartung fÃ¤llig</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* Mobile: Fixed Bottom Action Button */}\n      <div className=\"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-card border-t border-border shadow-lg\">\n        <Dialog open={checkoutDialogOpen} onOpenChange={setCheckoutDialogOpen}>\n          <DialogTrigger asChild>\n            <Button className=\"w-full h-14 text-base gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Werkzeug ausgeben\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Werkzeug ausgeben</DialogTitle>\n            </DialogHeader>\n            <CheckoutForm\n              werkzeuge={werkzeuge}\n              mitarbeiter={mitarbeiter}\n              activeCheckoutToolIds={activeCheckoutToolIds}\n              onSubmit={handleCheckoutSubmit}\n              onCancel={() => setCheckoutDialogOpen(false)}\n              submitting={submitting}\n            />\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Detail Sheet for checkout/return */}\n      <Sheet open={!!selectedCheckout} onOpenChange={() => setSelectedCheckout(null)}>\n        <SheetContent className=\"sm:max-w-md\">\n          <SheetHeader>\n            <SheetTitle>\n              {selectedCheckout?.werkzeugData?.fields.werkzeugname || 'Werkzeugdetails'}\n            </SheetTitle>\n          </SheetHeader>\n\n          {selectedCheckout && (\n            <div className=\"mt-6 space-y-6\">\n              {/* Tool Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Hersteller</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.hersteller || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Modell</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.modell || '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Seriennummer</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.werkzeugData?.fields.seriennummer || '-'}\n                  </p>\n                </div>\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Checkout Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgeliehen an</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.mitarbeiterData?.fields.vorname}{' '}\n                    {selectedCheckout.mitarbeiterData?.fields.nachname}\n                  </p>\n                  {selectedCheckout.mitarbeiterData?.fields.abteilung && (\n                    <p className=\"text-sm text-muted-foreground\">\n                      {selectedCheckout.mitarbeiterData.fields.abteilung}\n                    </p>\n                  )}\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Ausgabedatum</p>\n                  <p className=\"font-medium\">\n                    {selectedCheckout.fields.ausgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.ausgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Geplante RÃ¼ckgabe</p>\n                  <p\n                    className={`font-medium ${\n                      selectedCheckout.isOverdue ? 'text-destructive' : ''\n                    }`}\n                  >\n                    {selectedCheckout.fields.geplantes_rueckgabedatum\n                      ? format(\n                          parseISO(selectedCheckout.fields.geplantes_rueckgabedatum),\n                          'PPP',\n                          { locale: de }\n                        )\n                      : '-'}\n                    {selectedCheckout.isOverdue && (\n                      <span className=\"ml-2 text-sm\">\n                        ({selectedCheckout.daysOverdue} Tage Ã¼berfÃ¤llig)\n                      </span>\n                    )}\n                  </p>\n                </div>\n                {selectedCheckout.fields.verwendungszweck && (\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Verwendungszweck</p>\n                    <p className=\"font-medium\">{selectedCheckout.fields.verwendungszweck}</p>\n                  </div>\n                )}\n              </div>\n\n              <hr className=\"border-border\" />\n\n              {/* Return Form */}\n              <div>\n                <h3 className=\"font-semibold mb-4\">Werkzeug zurÃ¼ckgeben</h3>\n                <ReturnForm\n                  checkout={selectedCheckout}\n                  onSubmit={handleReturnSubmit}\n                  onCancel={() => setSelectedCheckout(null)}\n                  submitting={submitting}\n                />\n              </div>\n            </div>\n          )}\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}\n","structuredPatch":[{"oldStart":719,"oldLines":9,"newStart":719,"newLines":20,"lines":["       {/* Header - Mobile */}","       <header className=\"md:hidden flex items-center justify-between px-4 py-3 bg-card border-b border-border\">","         <h1 className=\"text-lg font-semibold\">Werkzeuge</h1>","-        <Badge variant=\"secondary\" className=\"text-xs\">","-          {werkzeuge.length} Werkzeuge","-        </Badge>","+        <div className=\"flex items-center gap-2\">","+          <Button","+            variant=\"ghost\"","+            size=\"icon\"","+            onClick={handleRefresh}","+            disabled={refreshing}","+            className=\"h-8 w-8\"","+          >","+            <RefreshCw className={`h-4 w-4 ${refreshing ? 'animate-spin' : ''}`} />","+          </Button>","+          <Badge variant=\"secondary\" className=\"text-xs\">","+            {werkzeuge.length} Werkzeuge","+          </Badge>","+        </div>","       </header>"," ","       {/* Main Content */}"]}],"userModified":false,"replaceAll":false}}
{"parentUuid":"b3c6e4b7-ff9e-4bae-b6de-3aedeb8d8573","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_017R7hXz3fPMTutCQRhgP8b3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01XRCC5vQpa4XAPqLL4xAerz","name":"TodoWrite","input":{"todos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"completed","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"in_progress","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":456,"cache_read_input_tokens":47400,"cache_creation":{"ephemeral_5m_input_tokens":456,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpkE3Y6KD1By58w9NZe","type":"assistant","uuid":"d98596ba-1871-478b-b920-26a9cc2e4e49","timestamp":"2026-02-06T12:35:01.685Z"}
{"parentUuid":"d98596ba-1871-478b-b920-26a9cc2e4e49","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01XRCC5vQpa4XAPqLL4xAerz","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"uuid":"2b67f394-3363-4529-8c7d-3d35d5720a37","timestamp":"2026-02-06T12:35:01.702Z","toolUseResult":{"oldTodos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"in_progress","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"pending","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}],"newTodos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"completed","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"in_progress","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}]}}
{"parentUuid":"2b67f394-3363-4529-8c7d-3d35d5720a37","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01DHryyKn1kYUkodPeQ3SDtL","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014n8D2sHAkLRuF2Cv5QdRWA","name":"Bash","input":{"command":"npm run build 2>&1","description":"Build project to verify compilation","timeout":60000}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":193,"cache_read_input_tokens":47856,"cache_creation":{"ephemeral_5m_input_tokens":193,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpkW4hiUCy1dwfKZqyh","type":"assistant","uuid":"d3c5c5df-b488-46a1-9271-efd322e48205","timestamp":"2026-02-06T12:35:05.079Z"}
{"parentUuid":"d3c5c5df-b488-46a1-9271-efd322e48205","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014n8D2sHAkLRuF2Cv5QdRWA","type":"tool_result","content":"> claude-react-base@0.0.0 build\n> tsc -b && vite build\n\nvite v7.2.4 building client environment for production...\ntransforming...\nâœ“ 2619 modules transformed.\nrendering chunks...\ncomputing gzip size...\ndist/index.html                   0.67 kB â”‚ gzip:   0.41 kB\ndist/assets/index-BApnZV7y.css  120.28 kB â”‚ gzip:  18.43 kB\ndist/assets/index-DVtLH-BS.js   395.16 kB â”‚ gzip: 118.51 kB\nâœ“ built in 5.83s","is_error":false}]},"uuid":"ad9a83f7-f157-40d9-888f-91fa780d6be0","timestamp":"2026-02-06T12:35:19.986Z","toolUseResult":{"stdout":"> claude-react-base@0.0.0 build\n> tsc -b && vite build\n\nvite v7.2.4 building client environment for production...\ntransforming...\nâœ“ 2619 modules transformed.\nrendering chunks...\ncomputing gzip size...\ndist/index.html                   0.67 kB â”‚ gzip:   0.41 kB\ndist/assets/index-BApnZV7y.css  120.28 kB â”‚ gzip:  18.43 kB\ndist/assets/index-DVtLH-BS.js   395.16 kB â”‚ gzip: 118.51 kB\nâœ“ built in 5.83s","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"ad9a83f7-f157-40d9-888f-91fa780d6be0","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01H1iP2wm3BTAkMMrPxUiT3v","type":"message","role":"assistant","content":[{"type":"text","text":"Build succeeded. Now deploying."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":279,"cache_read_input_tokens":48049,"cache_creation":{"ephemeral_5m_input_tokens":279,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpmr8EEpZWWhbgMwQTy","type":"assistant","uuid":"f1f4ed0f-3595-49a3-92f1-5a9d6d8cabc3","timestamp":"2026-02-06T12:35:22.654Z"}
{"parentUuid":"f1f4ed0f-3595-49a3-92f1-5a9d6d8cabc3","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01H1iP2wm3BTAkMMrPxUiT3v","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01CSteN9qSXNDtNB8FFq7CyX","name":"TodoWrite","input":{"todos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"completed","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"completed","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"in_progress","activeForm":"Deploying to GitHub"}]}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":279,"cache_read_input_tokens":48049,"cache_creation":{"ephemeral_5m_input_tokens":279,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpmr8EEpZWWhbgMwQTy","type":"assistant","uuid":"7c018a27-125a-455b-b160-48a5ae26ee3b","timestamp":"2026-02-06T12:35:23.671Z"}
{"parentUuid":"7c018a27-125a-455b-b160-48a5ae26ee3b","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01CSteN9qSXNDtNB8FFq7CyX","type":"tool_result","content":"Todos have been modified successfully. Ensure that you continue to use the todo list to track your progress. Please proceed with the current tasks if applicable"}]},"uuid":"50f46088-31c4-42e7-ad9e-57d3c09671c9","timestamp":"2026-02-06T12:35:23.704Z","toolUseResult":{"oldTodos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"completed","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"in_progress","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"pending","activeForm":"Deploying to GitHub"}],"newTodos":[{"content":"Add refresh button with last-updated timestamp to dashboard header","status":"completed","activeForm":"Adding refresh button with last-updated timestamp to dashboard header"},{"content":"Run npm build to verify changes compile","status":"completed","activeForm":"Running npm build to verify compilation"},{"content":"Deploy to GitHub","status":"in_progress","activeForm":"Deploying to GitHub"}]}}
{"parentUuid":"50f46088-31c4-42e7-ad9e-57d3c09671c9","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01BGB6visrzf8b4Uv42HxPmP","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DsowkgiauZZzHTaD2MumAF","name":"mcp__deploy_tools__deploy_to_github","input":{}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":201,"cache_read_input_tokens":48328,"cache_creation":{"ephemeral_5m_input_tokens":201,"ephemeral_1h_input_tokens":0},"output_tokens":29,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpn84g4foBco1zZ9ynR","type":"assistant","uuid":"88826195-0fad-47b3-96fe-94c67605cb53","timestamp":"2026-02-06T12:35:26.178Z"}
{"parentUuid":"88826195-0fad-47b3-96fe-94c67605cb53","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DsowkgiauZZzHTaD2MumAF","type":"tool_result","content":[{"type":"text","text":"Deployment Failed: Git Error (git push origin main): remote: error: GH013: Repository rule violations found for refs/heads/main.        \nremote: \nremote: - GITHUB PUSH PROTECTION        \nremote:   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”        \nremote:     Resolve the following violations before pushing again        \nremote: \nremote:     - Push cannot contain secrets        \nremote: \nremote:             \nremote:      (?) Learn how to resolve a blocked push        \nremote:      https://docs.github.com/code-security/secret-scanning/working-with-secret-scanning-and-push-protection/working-with-push-protection-from-the-command-line#resolving-a-blocked-push        \nremote:             \nremote:             \nremote:       â€”â€” GitHub Personal Access Token â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”        \nremote:        locations:        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:48        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:49        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:50        \nremote:             \nremote:        (?) To push, remove secret from commit(s) or follow this URL to allow the secret.        \nremote:        https://github.com/mnogodumalon/697b86cc1f64daaa335a3113/security/secret-scanning/unblock-secret/39IQvOvFYKAjN0rN8iGje90Syzj        \nremote:             \nremote: \nremote: \nTo https://github.com/mnogodumalon/697b86cc1f64daaa335a3113.git\n ! [remote rejected]   main -> main (push declined due to repository rule violations)\nerror: failed to push some refs to 'https://github.com/mnogodumalon/697b86cc1f64daaa335a3113.git'\n"}]}]},"uuid":"de65d4a1-5842-46d0-a022-559d62bf0008","timestamp":"2026-02-06T12:35:34.174Z","toolUseResult":[{"type":"text","text":"Deployment Failed: Git Error (git push origin main): remote: error: GH013: Repository rule violations found for refs/heads/main.        \nremote: \nremote: - GITHUB PUSH PROTECTION        \nremote:   â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”        \nremote:     Resolve the following violations before pushing again        \nremote: \nremote:     - Push cannot contain secrets        \nremote: \nremote:             \nremote:      (?) Learn how to resolve a blocked push        \nremote:      https://docs.github.com/code-security/secret-scanning/working-with-secret-scanning-and-push-protection/working-with-push-protection-from-the-command-line#resolving-a-blocked-push        \nremote:             \nremote:             \nremote:       â€”â€” GitHub Personal Access Token â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”        \nremote:        locations:        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:48        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:49        \nremote:          - commit: d00787c216d2b6a111686904f42927a75b780a08        \nremote:            path: .claude/debug/f82cc210-8543-479a-ae29-daf6c95fc05e.txt:50        \nremote:             \nremote:        (?) To push, remove secret from commit(s) or follow this URL to allow the secret.        \nremote:        https://github.com/mnogodumalon/697b86cc1f64daaa335a3113/security/secret-scanning/unblock-secret/39IQvOvFYKAjN0rN8iGje90Syzj        \nremote:             \nremote: \nremote: \nTo https://github.com/mnogodumalon/697b86cc1f64daaa335a3113.git\n ! [remote rejected]   main -> main (push declined due to repository rule violations)\nerror: failed to push some refs to 'https://github.com/mnogodumalon/697b86cc1f64daaa335a3113.git'\n"}]}
{"parentUuid":"de65d4a1-5842-46d0-a022-559d62bf0008","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01B3AffLpiCbm9dL2V44xmAn","type":"message","role":"assistant","content":[{"type":"text","text":"The push was blocked because a debug file contains secrets. I need to remove that file from the commit and retry."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":662,"cache_read_input_tokens":48529,"cache_creation":{"ephemeral_5m_input_tokens":662,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpnuFmcq6Pbig8qUYAo","type":"assistant","uuid":"222bf6b1-b58d-4536-961c-44036363e316","timestamp":"2026-02-06T12:35:37.326Z"}
{"parentUuid":"222bf6b1-b58d-4536-961c-44036363e316","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01B3AffLpiCbm9dL2V44xmAn","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01T1RacsYGqpsqfsCQhuBkSp","name":"Bash","input":{"command":"git log --oneline -3","description":"Check recent commits"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":662,"cache_read_input_tokens":48529,"cache_creation":{"ephemeral_5m_input_tokens":662,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpnuFmcq6Pbig8qUYAo","type":"assistant","uuid":"22ec0d24-40ab-4e11-902c-9c659d7ce032","timestamp":"2026-02-06T12:35:37.948Z"}
{"parentUuid":"22ec0d24-40ab-4e11-902c-9c659d7ce032","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01T1RacsYGqpsqfsCQhuBkSp","type":"tool_result","content":"d00787c2 Lilo Auto-Deploy\nd5fd4e3e Update sessions\n654a13d2 Save session","is_error":false}]},"uuid":"12285be9-836b-488b-a209-f90268c60e19","timestamp":"2026-02-06T12:35:38.008Z","toolUseResult":{"stdout":"d00787c2 Lilo Auto-Deploy\nd5fd4e3e Update sessions\n654a13d2 Save session","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"12285be9-836b-488b-a209-f90268c60e19","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01Vy96bwLMdbBpXq8eHFtiMe","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0164VhiHPJ2hkGsrGuVbzBD3","name":"Bash","input":{"command":"git reset HEAD~1 --soft","description":"Undo last commit keeping changes staged"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":144,"cache_read_input_tokens":49191,"cache_creation":{"ephemeral_5m_input_tokens":144,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpoBJAyS8kuvTzu48vR","type":"assistant","uuid":"fc5a2343-fa29-4283-8233-ce8884598f4d","timestamp":"2026-02-06T12:35:41.244Z"}
{"parentUuid":"fc5a2343-fa29-4283-8233-ce8884598f4d","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0164VhiHPJ2hkGsrGuVbzBD3","type":"tool_result","content":"","is_error":false}]},"uuid":"52e40adb-9bd9-4762-8bfb-b246088be15e","timestamp":"2026-02-06T12:35:43.749Z","toolUseResult":{"stdout":"","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"52e40adb-9bd9-4762-8bfb-b246088be15e","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01HzCYTEkcpW5eE3xTo2wDva","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0113zULPDBau2AmKRNhadANL","name":"Bash","input":{"command":"git reset HEAD .claude/debug/ && echo \"--- Adding to gitignore ---\" && echo \".claude/debug/\" >> .gitignore","description":"Unstage debug files and add to gitignore"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":109,"cache_read_input_tokens":49335,"cache_creation":{"ephemeral_5m_input_tokens":109,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpobnphjXo9nsevNjVQ","type":"assistant","uuid":"0b3681c3-f75a-4711-ace7-b64fce0c4370","timestamp":"2026-02-06T12:35:47.255Z"}
{"parentUuid":"0b3681c3-f75a-4711-ace7-b64fce0c4370","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0113zULPDBau2AmKRNhadANL","type":"tool_result","content":"Unstaged changes after reset:\nM\t.cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335\n--- Adding to gitignore ---","is_error":false}]},"uuid":"04b159b3-03e9-4e13-b19b-b20cbd0c40f0","timestamp":"2026-02-06T12:35:48.031Z","toolUseResult":{"stdout":"Unstaged changes after reset:\nM\t.cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335\n--- Adding to gitignore ---","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"04b159b3-03e9-4e13-b19b-b20cbd0c40f0","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01LGzMxWwytMxGCaGK1RHEiy","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_013CKAGCCb3UthGn8p5yqn5R","name":"Bash","input":{"command":"git status --short","description":"Check current git status"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":248,"cache_read_input_tokens":49444,"cache_creation":{"ephemeral_5m_input_tokens":248,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpov5uSJ9oXnpW5nc1s","type":"assistant","uuid":"7c1e9c38-11ea-4f24-b40a-c4d3aa7dee26","timestamp":"2026-02-06T12:35:50.668Z"}
{"parentUuid":"7c1e9c38-11ea-4f24-b40a-c4d3aa7dee26","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_013CKAGCCb3UthGn8p5yqn5R","type":"tool_result","content":"AM .cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM  .claude.json\nM  .claude.json.backup\n M .claude/debug/latest\nA  .claude/projects/-home-user-app/agent-71926e9f.jsonl\nA  .claude/projects/-home-user-app/agent-e2610e1b.jsonl\nAM .claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nA  .claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\nM  .claude/statsig/statsig.cached.evaluations.e2842e13cb\nM  .claude/statsig/statsig.last_modified_time.evaluations\nMM .claude/statsig/statsig.session_id.2656274335\nA  .claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\nA  .npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nM  claude_agent.py\nA  dist/assets/index-BApnZV7y.css\nD  dist/assets/index-CeJIyUhI.js\nA  dist/assets/index-DVtLH-BS.js\nD  dist/assets/index-VjbJPIdY.css\nM  dist/index.html\nM  src/pages/Dashboard.tsx\n?? .gitignore","is_error":false}]},"uuid":"bf521fdf-40b5-4a78-b8a9-62c72eab4287","timestamp":"2026-02-06T12:35:50.872Z","toolUseResult":{"stdout":"AM .cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM  .claude.json\nM  .claude.json.backup\n M .claude/debug/latest\nA  .claude/projects/-home-user-app/agent-71926e9f.jsonl\nA  .claude/projects/-home-user-app/agent-e2610e1b.jsonl\nAM .claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nA  .claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\nM  .claude/statsig/statsig.cached.evaluations.e2842e13cb\nM  .claude/statsig/statsig.last_modified_time.evaluations\nMM .claude/statsig/statsig.session_id.2656274335\nA  .claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\nA  .npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nM  claude_agent.py\nA  dist/assets/index-BApnZV7y.css\nD  dist/assets/index-CeJIyUhI.js\nA  dist/assets/index-DVtLH-BS.js\nD  dist/assets/index-VjbJPIdY.css\nM  dist/index.html\nM  src/pages/Dashboard.tsx\n?? .gitignore","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"bf521fdf-40b5-4a78-b8a9-62c72eab4287","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01GihkoUHApmKmeYoEBobmrC","type":"message","role":"assistant","content":[{"type":"text","text":"I also see the `.claude/debug/` file with the problematic secret was from the previous commit (`f82cc210`). Let me also make sure the debug folder references are excluded. Let me also check if the `.claude/debug/f82cc210...txt` file is still in the staging area:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":679,"cache_read_input_tokens":49692,"cache_creation":{"ephemeral_5m_input_tokens":679,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpp8E9rMdEXSiv1ZVn7","type":"assistant","uuid":"32450187-0870-47a3-8809-93f166e1326e","timestamp":"2026-02-06T12:35:54.936Z"}
{"parentUuid":"32450187-0870-47a3-8809-93f166e1326e","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01GihkoUHApmKmeYoEBobmrC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_015yBpB4NB2bSX6TCgxUw69d","name":"Bash","input":{"command":"git diff --cached --name-only | grep -i debug","description":"Check if debug files are still staged"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":679,"cache_read_input_tokens":49692,"cache_creation":{"ephemeral_5m_input_tokens":679,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpp8E9rMdEXSiv1ZVn7","type":"assistant","uuid":"654a0e26-c04c-4cb9-aeac-e786a96fd870","timestamp":"2026-02-06T12:35:55.688Z"}
{"parentUuid":"654a0e26-c04c-4cb9-aeac-e786a96fd870","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_015yBpB4NB2bSX6TCgxUw69d","type":"tool_result","content":".npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log","is_error":false}]},"uuid":"fc8db840-ead3-48a5-96c2-3f2c3ad9831e","timestamp":"2026-02-06T12:35:55.808Z","toolUseResult":{"stdout":".npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"fc8db840-ead3-48a5-96c2-3f2c3ad9831e","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01HzbwfDQFN8jap9x2VysZsy","type":"message","role":"assistant","content":[{"type":"text","text":"The `.claude/debug/` file is no longer staged. The npm debug log shouldn't contain secrets. Let me now re-add the gitignore and recommit:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":191,"cache_read_input_tokens":50371,"cache_creation":{"ephemeral_5m_input_tokens":191,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrppVGSJCCdPswdPtefV","type":"assistant","uuid":"7c2a8deb-8d49-4fb7-b85b-03af896993a3","timestamp":"2026-02-06T12:35:58.596Z"}
{"parentUuid":"7c2a8deb-8d49-4fb7-b85b-03af896993a3","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01HzbwfDQFN8jap9x2VysZsy","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01V1gvvmatkvpTNnnySTb7gs","name":"Bash","input":{"command":"git add .gitignore && git add -A && git diff --cached --name-only | grep \".claude/debug\"","description":"Stage gitignore and check for debug files"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":191,"cache_read_input_tokens":50371,"cache_creation":{"ephemeral_5m_input_tokens":191,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrppVGSJCCdPswdPtefV","type":"assistant","uuid":"97769d0f-a841-47dd-9eab-5e1a414c387b","timestamp":"2026-02-06T12:35:59.786Z"}
{"parentUuid":"97769d0f-a841-47dd-9eab-5e1a414c387b","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01V1gvvmatkvpTNnnySTb7gs","type":"tool_result","content":".claude/debug/latest","is_error":false}]},"uuid":"4fd1e057-e4d0-4f55-8948-8bb65a302417","timestamp":"2026-02-06T12:36:00.901Z","toolUseResult":{"stdout":".claude/debug/latest","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"4fd1e057-e4d0-4f55-8948-8bb65a302417","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01BnsJ7VqJeKhNk39Bcj1KZJ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01TBqo3pyCsBVoc5gHyZEge6","name":"Bash","input":{"command":"git reset HEAD .claude/debug/","description":"Unstage debug directory again"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":314,"cache_read_input_tokens":50562,"cache_creation":{"ephemeral_5m_input_tokens":314,"ephemeral_1h_input_tokens":0},"output_tokens":25,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrppsAKVW5w973rc14nb","type":"assistant","uuid":"f8f2efea-4076-4a71-80ee-2aff8a36cdd0","timestamp":"2026-02-06T12:36:04.733Z"}
{"parentUuid":"f8f2efea-4076-4a71-80ee-2aff8a36cdd0","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01TBqo3pyCsBVoc5gHyZEge6","type":"tool_result","content":"Unstaged changes after reset:\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335","is_error":false}]},"uuid":"c6b1445c-f68d-454c-8864-43f735bdf1b4","timestamp":"2026-02-06T12:36:04.856Z","toolUseResult":{"stdout":"Unstaged changes after reset:\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"c6b1445c-f68d-454c-8864-43f735bdf1b4","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01LfFSCHmk3BtD5UxXv6h5Cf","type":"message","role":"assistant","content":[{"type":"text","text":"I see the issue - the `.gitignore` is being picked up but the debug files may have been tracked before. Let me check and handle more carefully:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":168,"cache_read_input_tokens":50876,"cache_creation":{"ephemeral_5m_input_tokens":168,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqA25wN1Ag7ncE4vmW","type":"assistant","uuid":"c50bc649-c899-43fb-b7b3-97077f262c19","timestamp":"2026-02-06T12:36:07.699Z"}
{"parentUuid":"c50bc649-c899-43fb-b7b3-97077f262c19","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01LfFSCHmk3BtD5UxXv6h5Cf","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LzyaaxxhfoviAKi7ehJoyM","name":"Bash","input":{"command":"git rm --cached -r .claude/debug/ 2>/dev/null; git reset HEAD .claude/debug/ 2>/dev/null; echo \"Done\"","description":"Remove debug files from git tracking"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":168,"cache_read_input_tokens":50876,"cache_creation":{"ephemeral_5m_input_tokens":168,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqA25wN1Ag7ncE4vmW","type":"assistant","uuid":"5cc7f801-500b-47c6-a7d4-3a3169d6c6b7","timestamp":"2026-02-06T12:36:08.489Z"}
{"parentUuid":"5cc7f801-500b-47c6-a7d4-3a3169d6c6b7","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LzyaaxxhfoviAKi7ehJoyM","type":"tool_result","content":"rm '.claude/debug/72a93885-c669-40d3-9596-1962c7a26563.txt'\nrm '.claude/debug/latest'\nUnstaged changes after reset:\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335\nDone","is_error":false}]},"uuid":"0d018fcb-d396-490a-8750-a7a5969e0499","timestamp":"2026-02-06T12:36:09.389Z","toolUseResult":{"stdout":"rm '.claude/debug/72a93885-c669-40d3-9596-1962c7a26563.txt'\nrm '.claude/debug/latest'\nUnstaged changes after reset:\nM\t.claude/debug/latest\nM\t.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nM\t.claude/statsig/statsig.session_id.2656274335\nDone","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"0d018fcb-d396-490a-8750-a7a5969e0499","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_017tRFWEasjxPBCJRTFTdadp","type":"message","role":"assistant","content":[{"type":"text","text":"Good - the debug files have been removed from tracking. Now let me also remove the problematic `.txt` file reference. Let me also check the full `f82cc210` debug file:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":431,"cache_read_input_tokens":51044,"cache_creation":{"ephemeral_5m_input_tokens":431,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqVMgDsySvgKtB8tfm","type":"assistant","uuid":"97325ce3-e308-4fef-9026-658bf7d839ba","timestamp":"2026-02-06T12:36:12.169Z"}
{"parentUuid":"97325ce3-e308-4fef-9026-658bf7d839ba","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_017tRFWEasjxPBCJRTFTdadp","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01QaBA4JUqwdn5M3o9XsBC7j","name":"Bash","input":{"command":"git diff --cached --name-only","description":"List all currently staged files"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":431,"cache_read_input_tokens":51044,"cache_creation":{"ephemeral_5m_input_tokens":431,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqVMgDsySvgKtB8tfm","type":"assistant","uuid":"32cfd0c6-2f78-475c-9b24-147c05821004","timestamp":"2026-02-06T12:36:12.822Z"}
{"parentUuid":"32cfd0c6-2f78-475c-9b24-147c05821004","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01QaBA4JUqwdn5M3o9XsBC7j","type":"tool_result","content":".cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\n.claude.json\n.claude.json.backup\n.claude/projects/-home-user-app/agent-71926e9f.jsonl\n.claude/projects/-home-user-app/agent-e2610e1b.jsonl\n.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\n.claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\n.claude/statsig/statsig.cached.evaluations.e2842e13cb\n.claude/statsig/statsig.last_modified_time.evaluations\n.claude/statsig/statsig.session_id.2656274335\n.claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\n.gitignore\n.npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nclaude_agent.py\ndist/assets/index-BApnZV7y.css\ndist/assets/index-CeJIyUhI.js\ndist/assets/index-DVtLH-BS.js\ndist/assets/index-VjbJPIdY.css\ndist/index.html\nsrc/pages/Dashboard.tsx","is_error":false}]},"uuid":"e6768e4f-0d12-4469-b4ed-4caa6acceeb9","timestamp":"2026-02-06T12:36:12.882Z","toolUseResult":{"stdout":".cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\n.claude.json\n.claude.json.backup\n.claude/projects/-home-user-app/agent-71926e9f.jsonl\n.claude/projects/-home-user-app/agent-e2610e1b.jsonl\n.claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\n.claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\n.claude/statsig/statsig.cached.evaluations.e2842e13cb\n.claude/statsig/statsig.last_modified_time.evaluations\n.claude/statsig/statsig.session_id.2656274335\n.claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\n.gitignore\n.npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nclaude_agent.py\ndist/assets/index-BApnZV7y.css\ndist/assets/index-CeJIyUhI.js\ndist/assets/index-DVtLH-BS.js\ndist/assets/index-VjbJPIdY.css\ndist/index.html\nsrc/pages/Dashboard.tsx","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"e6768e4f-0d12-4469-b4ed-4caa6acceeb9","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_017yZRoLpSc19qiqiz75cBDG","type":"message","role":"assistant","content":[{"type":"text","text":"No `.claude/debug/` files in staging. Now let me try the deploy again:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":521,"cache_read_input_tokens":51475,"cache_creation":{"ephemeral_5m_input_tokens":521,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqkL5uBwLCzry8Z2ks","type":"assistant","uuid":"c75beaf7-ec19-4b4c-a77f-9ae6ee106c1d","timestamp":"2026-02-06T12:36:15.845Z"}
{"parentUuid":"c75beaf7-ec19-4b4c-a77f-9ae6ee106c1d","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_017yZRoLpSc19qiqiz75cBDG","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_017Kq8Mo6jywvNDDcRfYMAuq","name":"mcp__deploy_tools__deploy_to_github","input":{}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":521,"cache_read_input_tokens":51475,"cache_creation":{"ephemeral_5m_input_tokens":521,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqkL5uBwLCzry8Z2ks","type":"assistant","uuid":"25c941c9-10ba-4ed2-954a-61246bda59fc","timestamp":"2026-02-06T12:36:16.004Z"}
{"parentUuid":"25c941c9-10ba-4ed2-954a-61246bda59fc","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_017Kq8Mo6jywvNDDcRfYMAuq","type":"tool_result","content":[{"type":"text","text":"Deployment Failed: Git Error (git checkout -b main): fatal: a branch named 'main' already exists\n"}]}]},"uuid":"3e4aeeec-9390-4caa-8c7e-896d2531afab","timestamp":"2026-02-06T12:36:16.070Z","toolUseResult":[{"type":"text","text":"Deployment Failed: Git Error (git checkout -b main): fatal: a branch named 'main' already exists\n"}]}
{"parentUuid":"3e4aeeec-9390-4caa-8c7e-896d2531afab","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_013K7tvnnaNhnSnv98zoz4jp","type":"message","role":"assistant","content":[{"type":"text","text":"The deploy tool is failing because it tries to create a branch that already exists. Let me commit and push manually instead."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":262,"cache_read_input_tokens":51996,"cache_creation":{"ephemeral_5m_input_tokens":262,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqyw9CWu3psioZxkjd","type":"assistant","uuid":"e7ec9f23-55c8-4ef8-8c0a-b03a72651fce","timestamp":"2026-02-06T12:36:20.079Z"}
{"parentUuid":"e7ec9f23-55c8-4ef8-8c0a-b03a72651fce","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_013K7tvnnaNhnSnv98zoz4jp","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01QdUhf5CmBcf2nXR9PYF42S","name":"Bash","input":{"command":"git status --short","description":"Check current git status"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":262,"cache_read_input_tokens":51996,"cache_creation":{"ephemeral_5m_input_tokens":262,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrpqyw9CWu3psioZxkjd","type":"assistant","uuid":"5aa9ffe5-ff62-4a51-b674-f840471f7397","timestamp":"2026-02-06T12:36:20.606Z"}
{"parentUuid":"5aa9ffe5-ff62-4a51-b674-f840471f7397","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01QdUhf5CmBcf2nXR9PYF42S","type":"tool_result","content":"AM .cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM  .claude.json\nM  .claude.json.backup\n M .claude/debug/latest\nA  .claude/projects/-home-user-app/agent-71926e9f.jsonl\nA  .claude/projects/-home-user-app/agent-e2610e1b.jsonl\nAM .claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nA  .claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\nM  .claude/statsig/statsig.cached.evaluations.e2842e13cb\nM  .claude/statsig/statsig.last_modified_time.evaluations\nMM .claude/statsig/statsig.session_id.2656274335\nA  .claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\nA  .gitignore\nA  .npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nM  claude_agent.py\nA  dist/assets/index-BApnZV7y.css\nD  dist/assets/index-CeJIyUhI.js\nA  dist/assets/index-DVtLH-BS.js\nD  dist/assets/index-VjbJPIdY.css\nM  dist/index.html\nM  src/pages/Dashboard.tsx","is_error":false}]},"uuid":"36288355-9f6f-46f6-a57f-c91ab52646b4","timestamp":"2026-02-06T12:36:20.800Z","toolUseResult":{"stdout":"AM .cache/claude-cli-nodejs/-home-user-app/mcp-logs-deploy_tools/2026-02-06T12-34-14-309Z.txt\nM  .claude.json\nM  .claude.json.backup\n M .claude/debug/latest\nA  .claude/projects/-home-user-app/agent-71926e9f.jsonl\nA  .claude/projects/-home-user-app/agent-e2610e1b.jsonl\nAM .claude/projects/-home-user-app/f82cc210-8543-479a-ae29-daf6c95fc05e.jsonl\nA  .claude/shell-snapshots/snapshot-bash-1770381254671-wr7erf.sh\nM  .claude/statsig/statsig.cached.evaluations.e2842e13cb\nM  .claude/statsig/statsig.last_modified_time.evaluations\nMM .claude/statsig/statsig.session_id.2656274335\nA  .claude/todos/f82cc210-8543-479a-ae29-daf6c95fc05e-agent-f82cc210-8543-479a-ae29-daf6c95fc05e.json\nA  .gitignore\nA  .npm/_logs/2026-02-06T12_35_06_363Z-debug-0.log\nM  claude_agent.py\nA  dist/assets/index-BApnZV7y.css\nD  dist/assets/index-CeJIyUhI.js\nA  dist/assets/index-DVtLH-BS.js\nD  dist/assets/index-VjbJPIdY.css\nM  dist/index.html\nM  src/pages/Dashboard.tsx","stderr":"","interrupted":false,"isImage":false}}
{"parentUuid":"36288355-9f6f-46f6-a57f-c91ab52646b4","isSidechain":false,"userType":"external","cwd":"/home/user/app","sessionId":"f82cc210-8543-479a-ae29-daf6c95fc05e","version":"2.0.53","gitBranch":"main","slug":"lazy-hatching-quill","message":{"model":"claude-opus-4-6","id":"msg_01GfMoMK3SUjjm3pnMbqCo5K","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01X5avAp8yQcmigQL8xwGKDM","name":"Bash","input":{"command":"git add -A && git reset .claude/debug/ 2>/dev/null; git diff --cached --name-only | grep debug","description":"Stage all files except debug dir"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":549,"cache_read_input_tokens":52258,"cache_creation":{"ephemeral_5m_input_tokens":549,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CXrprLCJ4iX3xzdusYpKY","type":"assistant","uuid":"0e8eacd3-1826-4d22-b286-68dc76ab0d16","timestamp":"2026-02-06T12:36:23.623Z"}
